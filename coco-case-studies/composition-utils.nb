(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    202001,       4856]
NotebookOptionsPosition[    201617,       4841]
NotebookOutlinePosition[    202042,       4858]
CellTagsIndexPosition[    201999,       4855]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "This"}], " ", "notebook", " ", "contains", " ", 
    "various", " ", "utility", " ", "functions", " ", "that", " ", 
    "implement", " ", "the", " ", "analysis", " ", "of", " ", "confidence", 
    " ", "composition", " ", "case", " ", 
    RowBox[{"studies", ".", " ", "Execute"}], " ", "all", " ", "lines", " ", 
    "in", " ", "it", " ", "before", " ", "using", " ", "the", " ", "*", 
    RowBox[{"-", 
     RowBox[{"analysis", ".", "nb"}]}], " ", 
    RowBox[{"notebooks", "."}]}], " ", "***)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "plotPDF", ",", " ", "logit", ",", "logis", ",", " ", "plotDensity", ",",
       "plotDensity3D", ",", "plotPDF3D", ",", " ", "BinListsBy", ",", 
      "getMgConfs", ",", "pairElemWithList", ",", "estECE", ",", "estMCE", 
      ",", "estOECE", ",", " ", "estUECE", ",", " ", "brierScore", ",", " ", 
      "assnClfer", ",", " ", "outClfer", ",", " ", "calibEval", ",", 
      "calibEvalShort", ",", "dynP"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"verifiedUuvStateTowards", ",", "verifiedUuvStateAll"}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "loadMcFilenames", ",", "loadMcData", ",", "organizeMcData", ",", 
      "organizeUuvData", ",", " ", "calibrateMon", ",", "   ", 
      "addHeadingsToResultsMatrix", ",", "getRandomIdxSplit", ",", " ", 
      "loadAndOrganizeMcData", ",", "doValidationTuning", ",", 
      "loadAndOrganizeUuvData", ",", " ", "doTesting", ",", " ", 
      "getRandomIdxSplit", ",", " ", "validateAndTestMcMons", ",", 
      "doMcEvals"}], "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotPDF", "[", 
      RowBox[{"rv_", ",", " ", "left_", ",", " ", "right_"}], "]"}], ":=", 
     " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{"rv", ",", " ", "t"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", "left", ",", "right"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotPDF", "[", "rv_", "]"}], ":=", " ", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{"rv", ",", " ", "t"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", 
         RowBox[{"-", "0.1"}], ",", "1.1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotDensity", "[", "rv_", "]"}], ":=", " ", 
     RowBox[{"DensityPlot", "[", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{"rv", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotDensity3D", "[", "rv_", "]"}], ":=", " ", 
     RowBox[{"DiscretePlot3D", "[", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{"rv", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"ExtentSize", "\[Rule]", "Full"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotPDF3D", "[", "rv_", "]"}], ":=", " ", 
     RowBox[{"Plot3D", "[", 
      RowBox[{
       RowBox[{"PDF", "[", 
        RowBox[{"rv", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logit", "[", "x_", "]"}], " ", ":=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logis", "[", "x_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Exp", "@", "x"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "@", "x"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BinListsBy", "[", 
     RowBox[{"data_List", ",", "binspecs__List"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fs", ",", "idata", ",", "len", ",", "out"}], "}"}], ",", 
      RowBox[{
       RowBox[{"len", "=", 
        RowBox[{"Length", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fs", "=", 
        RowBox[{"{", "binspecs", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AllTrue", "[", 
          RowBox[{"fs", ",", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", 
                 RowBox[{"_", "?", "NumericQ"}], ",", 
                 RowBox[{"_", "?", "NumericQ"}]}], "}"}], "|", 
               RowBox[{"{", 
                RowBox[{"_", ",", 
                 RowBox[{"_", "?", "NumericQ"}], ",", 
                 RowBox[{"_", "?", "NumericQ"}], ",", 
                 RowBox[{"_", "?", "NumericQ"}]}], "}"}]}]}], "]"}], "&"}]}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{"idata", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"f", ",", "data"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"f", ",", 
               RowBox[{"fs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"idata", ",", 
            RowBox[{"Range", "[", "len", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"out", "=", 
           RowBox[{"BinLists", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "idata", "]"}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{"Rest", "/@", "fs"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"len", "+", "1"}], ",", 
               RowBox[{"len", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"out", "=", 
           RowBox[{"Part", "[", 
            RowBox[{"out", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"All", ",", 
                RowBox[{"Length", "[", "fs", "]"}]}], "]"}]}], ",", "1", ",", 
             "All", ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"data", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "out", ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "fs", "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "PrintTemporary", "[", 
           "\"\<Your specification is incorrect\[Ellipsis]\>\"", "]"}], 
          ";"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BinListsBy", "::", "usage"}], "=", 
     RowBox[{"Evaluate", "[", 
      RowBox[{
      "Uncompress", "@", 
       "\"\<1:eJztlctqwkAUhn2DvsLpPoUYobelha66qkt1McmcmFPMTHDGSxBfuE/\
RXKiSRCSOgyi6mTAXPv6f85+cR19+D34fOp0+iS9SWvXT4Xr0/\
vny0S3Wt2J9Hcx9Fcwo0X25GpYXq+LjOlBuy+\
fuuHJ6JMOzwOg1GJ7rPW8cWIctgVQFxiRMZNUpbFWhbMbgk1BGFqlCAhKg5kGAStECs53GCc5Kuo96\
iSis+AYmuBXr4DOFHKQAHSEs2HSOCjiGJLJTP4WYJQmJCYSgJSALIpBh/\
jQeuV3vHtOzxtQBTnajWqCygnKCJXEd3TN6fRltBVMJBhZ8NTFNa7ksMOZVIzQG8cQpRqFICjbN8yr\
ySmf1tdAA21j9B6gVMzzIbKus6bwGCuWszPLWfz3N54tzeoixcYyEGPVEeohhKKTZWMcL6dWEXMEAs\
ZEeC+G5wSl0IX27GyEX0r8nCrLfxztBtz5sjQryY6EgTUZRiL29mOm8xEGe/Q1ykZxptmeo/\
wEBvbZm\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"getMgConfs", "[", "mgFiles_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mgCons", " ", ",", "  ", "mgRawConfs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"mg", " ", "data"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"mgCons", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", " ", 
        RowBox[{"mgRawConfs", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"mgCons", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Import", "@", "#"}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"all", " ", "but", " ", "first", " ", "line"}], " ", 
                 "*)"}], " ", 
                RowBox[{
                 RowBox[{"2", ";;"}], " ", ",", 
                 RowBox[{"(*", 
                  RowBox[{"2", "nd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "it", " ", "was", " ", "deemed", " ", 
                    "consistent"}]}]}], " ", "*)"}], " ", "2"}], "]"}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"mgRawConfs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Import", "@", "#"}], ")"}], "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"all", " ", "but", " ", "first", " ", "line"}], " ", 
                 "*)"}], " ", 
                RowBox[{
                 RowBox[{"2", ";;"}], " ", ",", 
                 RowBox[{"(*", 
                  RowBox[{"2", "nd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "it", " ", "was", " ", "deemed", " ", 
                    "consistent"}]}]}], " ", "*)"}], " ", "3"}], "]"}], 
               "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ")"}], " ", 
          "&"}], " ", "/@", " ", "mgFiles"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "return", "*)"}], " ", "\[IndentingNewLine]", " ", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"mgCons", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "\[Equal]", " ", 
               "1"}], ",", " ", 
              RowBox[{"mgRawConfs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", " ", 
              RowBox[{"1", "-", " ", 
               RowBox[{"mgRawConfs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], 
            "\[IndentingNewLine]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "@", 
               RowBox[{"mgCons", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "mgCons"}]}], "}"}]}], "]"}]}]}], " ", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "triples", " ", "have", " ", "the", " ", "average", " ", "confidence"}], 
     ",", " ", 
     RowBox[{"the", " ", "average", " ", "accuracy"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "count", " ", "of", " ", "occurrences"}]}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "pair", " ", "one", " ", "element", " ", "with", " ", "each", " ", 
     "element", " ", "of", " ", "a", " ", "list"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pairElemWithList", "[", "a_", "]"}], " ", ":=", " ", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"a", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{"a", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "ECE", " ", "empirical", " ", "estimates", " ", "over", " ", "the", " ", 
     "binning", " ", "error", " ", "structure"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"estECE", "[", "triples_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], " ", "*", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", "&"}], "/@", 
         " ", "triples"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"Plus", "@@", 
        RowBox[{"triples", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"max", " ", "calib", " ", "error"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"estMCE", "[", "triples_", "]"}], ":=", " ", 
     RowBox[{"Max", "@", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
        "triples"}], ")"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"overconfidence", " ", "error"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"estCCE", "[", "triples_", "]"}], ":=", " ", 
     RowBox[{"Max", "@@", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "  ", "&"}], "/@", " ", 
        "triples"}], ")"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"estMCE", "[", "triples_", "]"}], ":=", " ", 
      RowBox[{"Max", "@@", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", " ", 
         "triples"}], ")"}]}]}], ";", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"--", " ", "this"}], " ", "was", " ", "non"}], "-", 
      "conservative"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"estOECE", "[", "triples_", "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"overconfTriples", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"triples", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ">", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", "*", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", "&"}], "/@", 
           " ", "overconfTriples"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", 
          RowBox[{"overconfTriples", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"estUECE", "[", "triples_", "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"underconfTriples", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"triples", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<=", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", "*", " ", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], " ", "&"}], "/@", 
           " ", "underconfTriples"}], ")"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", 
          RowBox[{"underconfTriples", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"brierScore", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Plus", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"pairs", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<True\>\"", "\[Rule]", "1"}], ",", 
             RowBox[{"True", "\[Rule]", "1"}], ",", " ", 
             RowBox[{"\"\<False\>\"", "\[Rule]", "0"}], ",", " ", 
             RowBox[{"False", "\[Rule]", "0"}]}], "}"}]}], ")"}]}], ")"}]}], 
      " ", "/", 
      RowBox[{"Length", "@", "pairs"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"classifier", " ", "measures"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"roc", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ClassifierMeasurements", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<True\>\"", "\[Rule]", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"True", "\[Rule]", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\"\<False\>\"", "\[Rule]", " ", 
             RowBox[{"1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", " ", 
            RowBox[{"False", "->", 
             RowBox[{"1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "|>"}], "&"}], "/@", 
         "pairs"}], ",", " ", 
        RowBox[{"pairs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
        "\"\<ROCCurve\>\""}], "]"}], "[", "\"\<True\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"auc", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"ClassifierMeasurements", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<True\>\"", "\[Rule]", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"True", "\[Rule]", " ", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\"\<False\>\"", "\[Rule]", " ", 
             RowBox[{"1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{"False", "->", 
             RowBox[{"1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}]}], "|>"}], "&"}], "/@", 
         "pairs"}], ",", " ", 
        RowBox[{"pairs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", " ", 
        "\"\<AreaUnderROCCurve\>\""}], "]"}], "[", "\"\<True\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "utility", " ", "function", " ", "to", " ", "not", " ", "have", " ", 
      "probabilities", " ", "exactly", " ", "0", " ", "or", " ", "1"}], ",", 
     " ", 
     RowBox[{
      RowBox[{"which", " ", "messes", " ", "with", " ", "log"}], "-", 
      "likelihoods"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fixExtremeProbs", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
             RowBox[{"1", "-", "1*^-8"}]}], " ", "]"}], ",", " ", "1*^-8"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}], " ", "&"}], "/@", 
      "pairs"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"using", " ", "in", " ", "uuv"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"fixExtremeProbs2", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
             RowBox[{"1", "-", "1*^-5"}]}], " ", "]"}], ",", " ", "1*^-5"}], 
          "]"}]}], " ", "}"}], " ", "&"}], "/@", "pairs"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"outcome", " ", 
     RowBox[{"classifier", ":", " ", 
      RowBox[{
      "uses", " ", "the", " ", "1", "st", " ", "element", " ", "of", " ", "a",
        " ", "pair"}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"outClfer", " ", "=", " ", 
     RowBox[{"Classify", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", " ", "False"}], "}"}], " ", "\[Rule]", " ", 
         "True"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", " ", "True"}], "}"}], " ", "\[Rule]", " ", 
         "True"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"False", ",", " ", "False"}], "}"}], " ", "\[Rule]", " ", 
         "False"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"False", ",", " ", "True"}], "}"}], " ", "\[Rule]", " ", 
         "False"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"assumption", " ", 
     RowBox[{"classifier", ":", " ", 
      RowBox[{
      "uses", " ", "the", " ", "2", "nd", " ", "element", " ", "of", " ", "a",
        " ", "pair"}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"assnClfer", " ", "=", " ", "\[IndentingNewLine]", 
     RowBox[{"Classify", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", " ", "False"}], "}"}], " ", "\[Rule]", " ", 
         "False"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"True", ",", " ", "True"}], "}"}], " ", "\[Rule]", " ", 
         "True"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"False", ",", " ", "False"}], "}"}], " ", "\[Rule]", " ", 
         "False"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"False", ",", " ", "True"}], "}"}], " ", "\[Rule]", " ", 
         "True"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"show", " ", "evaluation", " ", "of", " ", "the", " ", 
      RowBox[{"predictor", ":", "\[IndentingNewLine]", " ", "ECE"}]}], ",", 
     " ", "MCE", ",", " ", "OECE", ",", " ", "UECE", ",", " ", 
     RowBox[{"Brier", " ", "score"}], ",", "  ", 
     RowBox[{"and", " ", "a", " ", "calibration", " ", "plot"}]}], " ", 
    "\[IndentingNewLine]", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "triples", " ", "have", " ", "the", " ", "average", " ", "confidence"}], 
     ",", " ", 
     RowBox[{"the", " ", "average", " ", "accuracy"}], ",", " ", 
     RowBox[{
     "and", " ", "the", " ", "count", " ", "of", " ", "occurrences"}]}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calTriples", "[", "pairs_", "]"}], " ", ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "@", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "  ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "#"}], " ", ">", "0"}], " ", ",", " ", 
             RowBox[{
              RowBox[{"N", "@", 
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"\"\<True\>\"", "|", "True"}]}], "]"}]}], "/", 
              RowBox[{"Length", "@", "#"}]}], ",", " ", "Indeterminate"}], 
            "]"}], " ", ",", " ", 
           RowBox[{"Length", "@", "#"}]}], "}"}], " ", "\[IndentingNewLine]", 
         "&"}], "/@", " ", 
        RowBox[{"BinListsBy", "[", 
         RowBox[{"pairs", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", " ", "0", ",", 
            "1.1", ",", "0.1"}], "}"}]}], "]"}]}], ")"}], "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{"{", "}"}], "]"}], ",", "Indeterminate", ",", "0"}], "}"}], 
       "\[Rule]", 
       RowBox[{"Sequence", "[", "]"}]}]}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calibEval", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triples", " ", "=", " ", 
         RowBox[{"calTriples", "[", "pairs", "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"estECE", "@", "triples"}], ",", "\[IndentingNewLine]", 
         RowBox[{"estMCE", "@", "triples"}], ",", "\[IndentingNewLine]", 
         RowBox[{"estCCE", "@", " ", "triples"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"estUECE", "@", " ", "triples"}], ","}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"brierScore", "@", "pairs"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"Plot", "[", 
            RowBox[{"x", ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"triples", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", " ", 
             RowBox[{"Filling", "\[Rule]", "Axis"}], ",", " ", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"Plus", "@@", 
                    RowBox[{"triples", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ")"}]}]}], 
                "}"}], "&"}], "/@", " ", 
              RowBox[{"triples", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], ",", " ", 
             
             RowBox[{"Filling", "\[Rule]", "None"}], ",", " ", 
             RowBox[{"PlotStyle", "\[Rule]", "Orange"}], ",", " ", 
             RowBox[{"PlotMarkers", "\[Rule]", "\"\<*\>\""}]}], "]"}]}], " ", 
          "]"}]}], "\[IndentingNewLine]", "}"}]}], " ", "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calibEvalShort", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"triples", " ", "=", " ", 
         RowBox[{"calTriples", "[", "pairs", "]"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"estECE", "@", "triples"}], ",", "\[IndentingNewLine]", 
         RowBox[{"estMCE", "@", "triples"}], ",", "\[IndentingNewLine]", 
         RowBox[{"estCCE", "@", "triples"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"brierScore", "@", "pairs"}], ",", " ", "0.00001"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"auc", "[", 
          RowBox[{"pairs", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"True", "\[Rule]", "\"\<True\>\""}], ",", 
             RowBox[{"False", "\[Rule]", "\"\<False\>\""}]}], "}"}]}], 
          "]"}]}], "\[IndentingNewLine]", "}"}]}], " ", "\[IndentingNewLine]",
       "]"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Classifier", " ", "metrics"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"acc", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
            RowBox[{"ToString", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", 
               "0.5"}], ")"}]}]}], ")"}], "&"}], "/@", "pairs"}], ",", " ", 
        RowBox[{"True", "|", "\"\<True\>\""}]}], "]"}], "/", 
      RowBox[{"Length", "@", "pairs"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prec", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
               "\"\<True\>\""}], "\[Or]", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "True"}]}], ")"}],
             "\[And]", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
             RowBox[{"ToString", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", 
                "0.5"}], ")"}]}]}]}], ")"}], "&"}], "/@", "pairs"}], ",", " ", 
        RowBox[{"True", "|", "\"\<True\>\""}]}], "]"}], "/", 
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", "0.5"}], 
          "&"}], "/@", "pairs"}], ",", " ", "True"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rec", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
               "\"\<True\>\""}], "\[Or]", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "True"}]}], ")"}],
             " ", "\[And]", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
             RowBox[{"ToString", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", " ", 
                "0.5"}], ")"}]}]}]}], ")"}], "&"}], "/@", "pairs"}], ",", " ", 
        RowBox[{"True", "|", "\"\<True\>\""}]}], "]"}], "/", 
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "\[Equal]", " ", 
             "\"\<True\>\""}], "\[Or]", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "True"}]}], ")"}], 
          "&"}], "/@", "pairs"}], ",", " ", 
        RowBox[{"True", "|", "\"\<True\>\""}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f1", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{"2", "*", 
      RowBox[{"prec", "[", "pairs", "]"}], "*", 
      RowBox[{
       RowBox[{"rec", "[", "pairs", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"prec", "[", "pairs", "]"}], "+", 
         RowBox[{"rec", "[", "pairs", "]"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"classEval", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{"N", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"acc", "[", "pairs", "]"}], ",", " ", 
        RowBox[{"prec", "[", "pairs", "]"}], ",", " ", 
        RowBox[{"rec", "[", "pairs", "]"}], ",", " ", 
        RowBox[{"f1", "[", "pairs", "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"compose", " ", "two", " ", "pairs"}], "-", 
     RowBox[{"arrays", " ", "of", " ", 
      RowBox[{"(", 
       RowBox[{"binary", ",", " ", "confs"}], ")"}], " ", "using", " ", "two",
       " ", "designated", " ", "operations"}]}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"composeMons", "[", 
      RowBox[{
      "pairs1_", ",", " ", "pairs2_", ",", " ", "opBinary_", ",", " ", 
       "opConfs_"}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"opBinary", "[", 
           RowBox[{
            RowBox[{"ToExpression", "@", 
             RowBox[{"pairs1", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], " ", ",", " ", 
            RowBox[{"ToExpression", "@", 
             RowBox[{"pairs2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"opConfs", "[", 
          RowBox[{
           RowBox[{"pairs1", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"pairs2", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "@", "pairs1"}]}], "}"}]}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Calibration", "-", "related"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"calculate", " ", "negative", " ", "log"}], "-", 
     RowBox[{"likelihood", " ", "from", " ", "pairs", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"binary", " ", "result"}], ",", " ", 
        RowBox[{"predictive", " ", "prob"}]}], ")"}]}]}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"weird", " ", "version"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nll", "[", "pairs_", "]"}], " ", ":=", " ", 
     RowBox[{"Plus", "@@", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"preppedPairs", " ", "=", " ", 
          RowBox[{"pairs", " ", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<True\>\"", "\[Rule]", "1"}], ",", " ", 
             RowBox[{"\"\<False\>\"", "\[Rule]", "0"}], ",", " ", 
             RowBox[{"True", "\[Rule]", "1"}], ",", " ", 
             RowBox[{"False", "\[Rule]", "0"}]}], " ", "}"}]}]}], "}"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}]}], "&"}], 
         "/@", "preppedPairs"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"weighted", " ", "and", " ", "better", " ", "version"}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nllNewW", "[", 
      RowBox[{"pairs_", ",", "consW_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Plus", "@@", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"preppedPairs", " ", "=", " ", 
          RowBox[{"pairs", " ", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<True\>\"", "\[Rule]", "1"}], ",", " ", 
             RowBox[{"\"\<False\>\"", "\[Rule]", "0"}], ",", " ", 
             RowBox[{"True", "\[Rule]", "1"}], ",", " ", 
             RowBox[{"False", "\[Rule]", "0"}]}], " ", "}"}]}]}], "}"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "consW"}], ")"}]}], "*", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"Log", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], " ", "-", " ", 
           RowBox[{"consW", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"Log", "[", 
             RowBox[{"1", "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "&"}], "/@", 
         "preppedPairs"}]}], "\[IndentingNewLine]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"sigmoid", " ", "with", " ", "temp", " ", 
     RowBox[{"t", ":", " ", 
      RowBox[{
       RowBox[{"from", " ", "log"}], "-", 
       RowBox[{
       "odds", " ", "to", " ", "probs", " ", "\[IndentingNewLine]", "also", 
        " ", "sigmoid", " ", "with", " ", "regression"}]}]}]}], "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sig", "[", 
      RowBox[{"val_", ",", "t_"}], "]"}], " ", ":=", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "val"}], "/", "t"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sig", "[", 
      RowBox[{"val_", ",", " ", "a_", ",", " ", "b_"}], "]"}], ":=", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "val"}], "*", "a"}], " ", "+", " ", "b"}], "]"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"sigmoid", " ", "with", " ", "temp", " ", "t", " ", "over", " ", 
     RowBox[{"pairs", ":", " ", 
      RowBox[{
       RowBox[{"from", " ", "log"}], "-", 
       RowBox[{"odds", " ", "to", " ", "probs"}]}]}]}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sigPairs", "[", 
      RowBox[{"pairs_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"sig", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", "t"}], "]"}]}], "}"}], 
       "&"}], "/@", "pairs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sigPairs", "[", 
      RowBox[{"pairs_", ",", " ", "a_", ",", " ", "b_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"sig", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", "a", ",", " ", "b"}], 
          "]"}]}], "}"}], "&"}], "/@", "pairs"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"log", "-", 
     RowBox[{"odds", " ", "over", " ", 
      RowBox[{"pairs", ":", " ", 
       RowBox[{
        RowBox[{"from", " ", "probs", " ", "to", " ", "log"}], "-", 
        "odds"}]}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"logOddsPairs", "[", "pairs_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Log", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}], 
       "&"}], "/@", "pairs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "multiply", " ", "each", " ", "second", " ", "element", " ", "of", " ", 
     "a", " ", "pair", " ", "by", " ", "a", " ", "given", " ", "factor"}], 
    " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"prodPairs", "[", 
      RowBox[{"pairs_", ",", " ", "t_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
         RowBox[{"t", "*", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
      "pairs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "partition", " ", "list", " ", "into", " ", "varying", " ", "lengths"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dynP", "[", 
     RowBox[{"l_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"MapThread", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"l", "[", 
        RowBox[{"[", 
         RowBox[{"#", ";;", "#2"}], "]"}], "]"}], "&"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", "0", "}"}], "~", "Join", "~", 
            RowBox[{"Most", "@", "#"}]}], "+", "1"}], ",", "#"}], "}"}], 
        "&"}], "@", 
       RowBox[{"Accumulate", "@", "p"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"histogram", " ", "related", " ", "functions"}], " ", "*)"}], " ",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pointToHist", "[", 
      RowBox[{"hist_", ",", " ", "x_", ",", " ", "y_"}], "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xpos", ",", " ", "ypos"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xpos", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FirstPosition", "[", 
             RowBox[{
              RowBox[{"hist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"_", "?", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"#", ">", "x"}], "&"}], ")"}]}]}], "]"}], "-", "1"}],
            ",", " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ypos", "=", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FirstPosition", "[", 
             RowBox[{
              RowBox[{"hist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#", ">", "y"}], "&"}], ")"}]}]}], "]"}], "-", "1"}],
            ",", " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hist", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "xpos", ",", "ypos"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"normalizeHist", "[", "h_", "]"}], ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"10", "^", 
           RowBox[{"-", "5"}]}]}], ")"}], "/", 
        RowBox[{"Plus", "@@", 
         RowBox[{"(", 
          RowBox[{"Flatten", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"h", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", 
             RowBox[{"10", "^", 
              RowBox[{"-", "5"}]}]}], ")"}]}], ")"}]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Skd", "-", 
     RowBox[{"based", " ", 
      RowBox[{"bayes", ":", " ", 
       RowBox[{
       "make", " ", "one", " ", "updating", " ", "step", " ", "of", " ", 
        "baesian", " ", "estimation"}]}]}]}], "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bayesStepSkd", "[", " ", 
      RowBox[{
      "prior_", ",", " ", "mcMg_", ",", "jointSkdSat_", ",", " ", 
       "jointSkdAll_"}], "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mc", "=", 
          RowBox[{"mcMg", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{"mg", "=", 
          RowBox[{"mcMg", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"prior", "*", 
        RowBox[{
         RowBox[{"PDF", "[", 
          RowBox[{"jointSkdSat", ",", " ", 
           RowBox[{"{", 
            RowBox[{"mc", ",", "mg"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"PDF", "[", 
              RowBox[{"jointSkdSat", ",", " ", 
               RowBox[{"{", 
                RowBox[{"mc", ",", "mg"}], "}"}]}], "]"}], " ", "*", 
             "prior"}], " ", "+", "  ", 
            RowBox[{
             RowBox[{"PDF", "[", 
              RowBox[{"jointSkdAll", ",", " ", 
               RowBox[{"{", 
                RowBox[{"mc", ",", "mg"}], "}"}]}], "]"}], " ", "*", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "prior"}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"PDF", "[", 
           RowBox[{"jointSkdAll", ",", " ", 
            RowBox[{"{", 
             RowBox[{"mc", ",", "mg"}], "}"}]}], "]"}], " ", 
          "\[IndentingNewLine]", ")"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Skd", "-", 
     RowBox[{"based", " ", 
      RowBox[{"bayes", ":", " ", 
       RowBox[{
       "slides", " ", "bayes", " ", "over", " ", "a", " ", "whole", " ", 
        "run"}]}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"applyBayesSkd", "[", 
      RowBox[{
      "prior_", ",", "run_", ",", "jointSkdSat_", ",", " ", "jointSkdAll_"}], 
      " ", "]"}], ":=", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"FoldList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bayesStepSkd", " ", "[", 
           RowBox[{
           "#1", ",", " ", "#2", ",", " ", "jointSkdSat", ",", 
            "jointSkdAll"}], "]"}], "&"}], ",", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "prior", "}"}], ",", " ", "run"}], "]"}]}], "]"}], 
       " ", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Histogram", "-", 
     RowBox[{"based", " ", 
      RowBox[{"bayes", ":", " ", 
       RowBox[{
       "slides", " ", "bayes", " ", "over", " ", "a", " ", "whole", " ", 
        "run"}]}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"applyBayesHist", "[", 
      RowBox[{"prior_", ",", "run_", ",", "histTT_", ",", "histAll_"}], "]"}],
      ":=", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"FoldList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bayesStepHist", "[", 
           RowBox[{"#1", ",", " ", "#2", ",", " ", "histTT", ",", "histAll"}],
            "]"}], "&"}], ",", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "prior", "}"}], ",", " ", "run"}], "]"}]}], "]"}], 
       " ", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bayesStepHist", "[", " ", 
      RowBox[{"prior_", ",", " ", "mcMg_", ",", "histTT_", ",", "histAll_"}], 
      "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mc", "=", 
          RowBox[{"mcMg", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{"mg", "=", 
          RowBox[{"mcMg", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"prior", "*", 
        RowBox[{
         RowBox[{"pointToHist", "[", 
          RowBox[{"histTT", ",", "mc", ",", "mg"}], "]"}], "/", 
         RowBox[{"(", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"used", " ", "to", " ", 
            RowBox[{"be", ":", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"pointToHist", "[", 
                RowBox[{"histTT", ",", " ", "mc", ",", "mg"}], "]"}], " ", 
               "*", "prior"}], " ", "+", " ", 
              RowBox[{
               RowBox[{"(", "  ", 
                RowBox[{"pointToHist", "[", 
                 RowBox[{"histAll", ",", " ", "mc", ",", "mg"}], "]"}], ")"}],
                "*", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "prior"}], ")"}]}]}]}]}], "*)"}], " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"correct", ":"}], " ", "*)"}], " ", 
          RowBox[{"pointToHist", "[", 
           RowBox[{"histAll", ",", " ", "mc", ",", "mg"}], "]"}], 
          "\[IndentingNewLine]", ")"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Fixed", " ", 
     RowBox[{"bayes", ":"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"applyBayesFix", "[", 
      RowBox[{"prior_", ",", "run_", ",", "histTT_", ",", "histNotSat_"}], 
      "]"}], ":=", " ", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"FoldList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bayesStepFix", "[", 
           RowBox[{
           "#1", ",", " ", "#2", ",", " ", "histTT", ",", "histNotSat"}], 
           "]"}], "&"}], ",", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "prior", "}"}], ",", " ", "run"}], "]"}]}], "]"}], 
       " ", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bayesStepFix", "[", " ", 
      RowBox[{
      "prior_", ",", " ", "mcMg_", ",", "histTT_", ",", "histNotSat_"}], 
      "]"}], ":=", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mc", "=", 
          RowBox[{"mcMg", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{"mg", "=", 
          RowBox[{"mcMg", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"prior", "*", 
        RowBox[{
         RowBox[{"pointToHist", "[", 
          RowBox[{"histTT", ",", "mc", ",", "mg"}], "]"}], "/", 
         RowBox[{"(", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pointToHist", "[", 
             RowBox[{"histTT", ",", " ", "mc", ",", "mg"}], "]"}], " ", "*", 
            "prior"}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", "  ", 
             RowBox[{"pointToHist", "[", 
              RowBox[{"histNotSat", ",", " ", "mc", ",", "mg"}], "]"}], ")"}],
             "*", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "prior"}], ")"}]}]}], "\[IndentingNewLine]", 
          ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"just", " ", "encodes", " ", "the", " ", "boundary"}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"verifiedUuvStateTowards", "[", 
      RowBox[{"y_", ",", " ", "h_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "h", "\[LessEqual]", "2.5"}], " ", 
        "\[And]", " ", 
        RowBox[{"10.05", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], ")"}],
       " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2.5", "\[LessEqual]", "h", "\[LessEqual]", "3.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.1", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3.5", "\[LessEqual]", "h", "\[LessEqual]", "4"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.15", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", "\[LessEqual]", "h", "\[LessEqual]", "4.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.2", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4.5", "\[LessEqual]", "h", "\[LessEqual]", "5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.25", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5", "\[LessEqual]", "h", "\[LessEqual]", "5.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.3", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"5.5", "\[LessEqual]", "h", "\[LessEqual]", "6"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.35", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", "\[LessEqual]", "h", "\[LessEqual]", "6.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.4", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6.5", "\[LessEqual]", "h", "\[LessEqual]", "7"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.5", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"7", "\[LessEqual]", "h", "\[LessEqual]", "7.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.6", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"7.5", "\[LessEqual]", "h", "\[LessEqual]", "8"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.7", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\[IndentingNewLine]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8", "\[LessEqual]", "h", "\[LessEqual]", "8.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.8", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"8.5", "\[LessEqual]", "h", "\[LessEqual]", "9"}], " ", 
         "\[And]", " ", 
         RowBox[{"10.9", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"9", "\[LessEqual]", "h", "\[LessEqual]", "9.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.05", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"9.5", "\[LessEqual]", "h", "\[LessEqual]", "10"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.15", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10", "\[LessEqual]", "h", "\[LessEqual]", "10.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.3", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"10.5", "\[LessEqual]", "h", "\[LessEqual]", "11"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.45", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"11", "\[LessEqual]", "h", "\[LessEqual]", "11.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.6", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"11.5", "\[LessEqual]", "h", "\[LessEqual]", "12"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.8", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"12", "\[LessEqual]", "h", "\[LessEqual]", "12.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"11.95", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"12.5", "\[LessEqual]", "h", "\[LessEqual]", "13"}], " ", 
         "\[And]", " ", 
         RowBox[{"12.15", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\[IndentingNewLine]", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"13", "\[LessEqual]", "h", "\[LessEqual]", "13.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"12.35", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"13.5", "\[LessEqual]", "h", "\[LessEqual]", "14"}], " ", 
         "\[And]", " ", 
         RowBox[{"12.55", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"14", "\[LessEqual]", "h", "\[LessEqual]", "14.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"12.75", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"14.5", "\[LessEqual]", "h", "\[LessEqual]", "15"}], " ", 
         "\[And]", " ", 
         RowBox[{"12.95", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"15", "\[LessEqual]", "h", "\[LessEqual]", "15.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"13.2", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"15.5", "\[LessEqual]", "h", "\[LessEqual]", "16"}], " ", 
         "\[And]", " ", 
         RowBox[{"13.4", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"16", "\[LessEqual]", "h", "\[LessEqual]", "16.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"13.6", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"16.5", "\[LessEqual]", "h", "\[LessEqual]", "17"}], " ", 
         "\[And]", " ", 
         RowBox[{"13.85", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"17", "\[LessEqual]", "h", "\[LessEqual]", "17.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"14.05", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"17.5", "\[LessEqual]", "h", "\[LessEqual]", "18"}], " ", 
         "\[And]", " ", 
         RowBox[{"14.25", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"18", "\[LessEqual]", "h", "\[LessEqual]", "18.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"14.5", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"18.5", "\[LessEqual]", "h", "\[LessEqual]", "19"}], " ", 
         "\[And]", " ", 
         RowBox[{"14.7", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"19", "\[LessEqual]", "h", "\[LessEqual]", "19.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"14.9", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"19.5", "\[LessEqual]", "h", "\[LessEqual]", "20"}], " ", 
         "\[And]", " ", 
         RowBox[{"15.15", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20", "\[LessEqual]", "h", "\[LessEqual]", "20.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"15.35", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"20.5", "\[LessEqual]", "h", "\[LessEqual]", "21"}], " ", 
         "\[And]", " ", 
         RowBox[{"15.55", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"21", "\[LessEqual]", "h", "\[LessEqual]", "21.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"15.75", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"21.5", "\[LessEqual]", "h", "\[LessEqual]", "22"}], " ", 
         "\[And]", " ", 
         RowBox[{"16", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], ")"}]}],
       " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"22", "\[LessEqual]", "h", "\[LessEqual]", "22.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"16.2", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"22.5", "\[LessEqual]", "h", "\[LessEqual]", "23"}], " ", 
         "\[And]", " ", 
         RowBox[{"16.4", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"23", "\[LessEqual]", "h", "\[LessEqual]", "23.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"16.6", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"23.5", "\[LessEqual]", "h", "\[LessEqual]", "24"}], " ", 
         "\[And]", " ", 
         RowBox[{"16.85", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"24", "\[LessEqual]", "h", "\[LessEqual]", "24.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"17.05", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"24.5", "\[LessEqual]", "h", "\[LessEqual]", "25"}], " ", 
         "\[And]", " ", 
         RowBox[{"17.25", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"25", "\[LessEqual]", "h", "\[LessEqual]", "25.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"17.45", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"25.5", "\[LessEqual]", "h", "\[LessEqual]", "26"}], " ", 
         "\[And]", " ", 
         RowBox[{"17.65", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"26", "\[LessEqual]", "h", "\[LessEqual]", "26.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"17.85", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"26.5", "\[LessEqual]", "h", "\[LessEqual]", "27"}], " ", 
         "\[And]", " ", 
         RowBox[{"18.1", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"27", "\[LessEqual]", "h", "\[LessEqual]", "27.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"18.3", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"27.5", "\[LessEqual]", "h", "\[LessEqual]", "28"}], " ", 
         "\[And]", " ", 
         RowBox[{"18.5", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"28", "\[LessEqual]", "h", "\[LessEqual]", "28.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"18.7", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"28.5", "\[LessEqual]", "h", "\[LessEqual]", "29"}], " ", 
         "\[And]", " ", 
         RowBox[{"18.9", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"29", "\[LessEqual]", "h", "\[LessEqual]", "29.5"}], " ", 
         "\[And]", " ", 
         RowBox[{"19.1", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}], " ", "\[Or]", " ", 
      RowBox[{"\\\n", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"29.5", "\[LessEqual]", "h", "\[LessEqual]", "30"}], " ", 
         "\[And]", " ", 
         RowBox[{"19.3", "\[LessEqual]", "y", "\[LessEqual]", "50"}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"verifiedUuvStateAll", "[", 
      RowBox[{"y_", ",", " ", "h_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"verifiedUuvStateTowards", "[", 
       RowBox[{"y", ",", "h"}], "]"}], " ", "\[Or]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"h", "\[LessEqual]", " ", "0"}], "\[And]", " ", 
        RowBox[{"10.1", "\[LessEqual]", "y"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"**", 
      RowBox[{"*", " ", "REPEATABLE", " ", "CROSS"}]}], "-", 
     RowBox[{"VALIDATED", " ", "MONITOR", " ", "ANALYSIS"}]}], " ", "****)"}],
    " ", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "loads", " ", "data", " ", "into", " ", "the", " ", "variables"}], ",", 
     " ", 
     RowBox[{"can", " ", "count", " ", "on", " ", "mcProbs"}], ",", " ", 
     "mgConfs", ",", " ", "successes"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadMcFilenames", "[", "dir_", "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"outcomeFiles", ",", "mcFiles", ",", "mgFiles"}], "]"}], ";", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"outcomeFiles", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"All", ",", "dir"}], "]"}], ",", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"-", "7"}]}], "]"}], "==", " ", "\"\<out.csv\>\""}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mcFiles", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"All", ",", "dir"}], "]"}], ",", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"-", "6"}]}], "]"}], "==", " ", "\"\<mc.csv\>\""}], 
           "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mgFiles", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"All", ",", "dir"}], "]"}], ",", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"#", ",", 
              RowBox[{"-", "16"}]}], "]"}], "==", " ", 
            "\"\<_mg_0.001500.csv\>\""}], "&"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "loads", " ", "data", " ", "into", " ", "the", " ", "variables"}], ",", 
     " ", 
     RowBox[{"can", " ", "count", " ", "on", " ", "mcProbs"}], ",", " ", 
     "mgConfs", ",", " ", "successes"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadUuvFilenames", "[", "dir_", "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", "trialDirs", "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"trialDirs", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"FileNames", "[", 
           RowBox[{"All", ",", "dir"}], "]"}], ",", "  ", 
          RowBox[{
           RowBox[{"DirectoryQ", "[", "#", "]"}], "&"}]}], "]"}]}], ";"}], 
      " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"particlesFiles", " ", "=", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"FileNames", "[", 
               RowBox[{"All", ",", 
                RowBox[{"#", "<>", "\"\</particles\>\""}]}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "4"}]}], "]"}], "==", " ", "\"\<.csv\>\""}], 
               "&"}]}], "]"}], "  ", ")"}], "&"}], "/@", " ", "trialDirs"}]}],
         ";"}], " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "load", " ", "MC", " ", "data", " ", "with", " ", "particular", " ", 
     "IDs"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadMcData", "[", 
      RowBox[{"idx_", ",", " ", "mgStepSize_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"successes", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"stepCounts", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "  ", 
       RowBox[{"noiseAssnHolds", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"steepAssnHolds", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"a1AndA2Holds", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"steeps", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"atLeastOneAssnHolds", "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"imp", "=", 
             RowBox[{"Import", "@", "#"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"successes", ",", " ", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"first", " ", "line"}], " ", "*)"}], " ", 
                RowBox[{"1", ",", 
                 RowBox[{"(*", 
                  RowBox[{"1", "st", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{
                    "success", " ", "wrt", " ", "the", " ", "goal"}]}]}], " ",
                   "*)"}], " ", "1"}], "]"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stepCounts", ",", " ", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"first", " ", "line"}], " ", "*)"}], " ", 
                RowBox[{"1", ",", 
                 RowBox[{"(*", 
                  RowBox[{"2", "nd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{"step", " ", "count"}]}]}], " ", "*)"}], " ", 
                 "2"}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"noiseAssnHolds", ",", " ", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"second", " ", "line"}], " ", "*)"}], " ", 
                RowBox[{"2", ",", 
                 RowBox[{"(*", 
                  RowBox[{"2", "nd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "the", " ", "noise", " ", "assumptions", 
                    " ", "hold"}]}]}], " ", "*)"}], " ", "2"}], "]"}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"steeps", ",", " ", 
                RowBox[{"imp", "[", 
                 RowBox[{"[", 
                  RowBox[{"(*", 
                   RowBox[{"second", " ", "line"}], " ", "*)"}], " ", 
                  RowBox[{"2", ",", 
                   RowBox[{"(*", 
                    RowBox[{"5", "th", " ", 
                    RowBox[{"element", ":", " ", 
                    RowBox[{
                    "the", " ", "steepness", " ", "of", " ", "the", " ", 
                    "hill"}]}]}], " ", "*)"}], " ", "5"}], "]"}], "]"}]}], 
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"steepAssnHolds", ",", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"second", " ", "line"}], " ", "*)"}], " ", 
                RowBox[{"2", ",", 
                 RowBox[{"(*", 
                  RowBox[{"3", "rd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{"steepness", " ", "assn"}]}]}], " ", "*)"}], " ", 
                 "3"}], "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"a1AndA2Holds", ",", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"second", " ", "line"}], " ", "*)"}], " ", 
                RowBox[{"2", ",", 
                 RowBox[{"(*", 
                  RowBox[{"1", "st", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{"both", " ", "assn", " ", "hold"}]}]}], "*)"}], 
                 "  ", "3"}], "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"atLeastOneAssnHolds", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{
                RowBox[{"ToExpression", "@", 
                 RowBox[{"noiseAssnHolds", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], " ", "\[Or]", " ", 
                RowBox[{"ToExpression", "@", 
                 RowBox[{"steepAssnHolds", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"(", " ", 
         RowBox[{"outcomeFiles", "[", 
          RowBox[{"[", "idx", "]"}], "]"}], ")"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mcProbs", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Import", "@", "#"}], " ", "&"}], " ", "/@", " ", 
              RowBox[{"(", 
               RowBox[{"mcFiles", "[", 
                RowBox[{"[", "idx", "]"}], "]"}], ")"}]}], ",", " ", 
             RowBox[{"(*", 
              RowBox[{"flatten", " ", "at", " ", "3", "rd", " ", "level"}], 
              "*)"}], 
             RowBox[{"{", "3", "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ")"}], 
         RowBox[{"(*", 
          RowBox[{
          "equalize", " ", "length", " ", "with", " ", "mg", " ", "probs"}], 
          "*)"}], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"mgStepSize", " ", ";;"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"mg", " ", "data"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       
       RowBox[{"mgCons", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"mgRawConfs", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"imp", " ", "=", " ", 
             RowBox[{"Import", "@", "#"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"mgCons", ",", " ", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"all", " ", "but", " ", "first", " ", "line"}], " ", 
                 "*)"}], " ", 
                RowBox[{
                 RowBox[{"2", ";;"}], " ", ",", 
                 RowBox[{"(*", 
                  RowBox[{"2", "nd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "it", " ", "was", " ", "deemed", " ", 
                    "consistent"}]}]}], " ", "*)"}], " ", "2"}], "]"}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"mgRawConfs", ",", " ", 
              RowBox[{"imp", "[", 
               RowBox[{"[", 
                RowBox[{"(*", 
                 RowBox[{"all", " ", "but", " ", "first", " ", "line"}], " ", 
                 "*)"}], " ", 
                RowBox[{
                 RowBox[{"2", ";;"}], " ", ",", 
                 RowBox[{"(*", 
                  RowBox[{"2", "nd", " ", 
                   RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "it", " ", "was", " ", "deemed", " ", 
                    "consistent"}]}]}], " ", "*)"}], " ", "3"}], "]"}], 
               "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], " ", 
         "&"}], " ", "/@", " ", 
        RowBox[{"(", 
         RowBox[{"mgFiles", "[", 
          RowBox[{"[", "idx", "]"}], "]"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"transforming", " ", "confidences", " ", "to", " ", "1"}], 
         "-", 
         RowBox[{"rawconf", " ", "when", " ", "not", " ", "consistent"}]}], 
        " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"mgConfs", " ", "=", " ", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"mgCons", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "\[Equal]", " ", 
               "1"}], ",", " ", 
              RowBox[{"mgRawConfs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", " ", 
              RowBox[{"1", "-", " ", 
               RowBox[{"mgRawConfs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], 
            "\[IndentingNewLine]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "@", 
               RowBox[{"mgCons", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "mgCons"}]}], "}"}]}], "]"}]}], " ", ";"}],
       "\[IndentingNewLine]", ")"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "loading", " ", "everything", " ", "for", " ", "checking", " ", "and", 
     " ", "creating", " ", "the", " ", "state", " ", "monitor"}], " ", "*)"}],
    " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadAllUuvData", "[", 
      RowBox[{"idx_", ",", " ", "mgStepSize_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"first", ",", " ", 
        RowBox[{"individual", " ", "data"}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tcRange", "=", " ", 
         RowBox[{"{", "}"}]}], ";"}], "*)"}], " ", 
      RowBox[{
       RowBox[{"trueHeads", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"usingLec1", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"times", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"pipedist", "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], 
       RowBox[{"findist", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"trueYs", "=", 
        RowBox[{"{", "}"}]}], ";", "  ", 
       RowBox[{"pfYs", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"pfRanges", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"pfHeadings", " ", "=", " ", 
        RowBox[{"{", "}"}]}], " ", ";", 
       RowBox[{"particles", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"particleYs", "=", 
        RowBox[{"{", "}"}]}], ";", "  ", 
       RowBox[{"particleHeads", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"particleDists", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"uuvSafe", "=", 
        RowBox[{"{", "}"}]}], ";", "   ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dir", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "need", " ", "processing", " ", "to", " ", "demolish", " ", 
               "non"}], "-", 
              RowBox[{"using", " ", "lec"}]}], ",", " ", 
             RowBox[{"0", "-", 
              RowBox[{"line", " ", "crossing"}]}], ",", " ", 
             RowBox[{
             "and", " ", "other", " ", "questionable", " ", "things"}]}], " ",
             "*)"}], " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"trueYsTemp", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Import", "[", 
                RowBox[{"dir", " ", "<>", " ", "\"\</uv_ys.csv\>\""}], "]"}], 
               " ", "//", " ", "Transpose"}], " ", "//", " ", "First"}]}], 
            ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "just", " ", "to", " ", "know", " ", "the", " ", "length"}], " ",
              "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"len", "=", " ", 
             RowBox[{"Length", "@", "trueYsTemp"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "the", " ", "number", " ", "of", " ", "meaningful", " ", 
              "samples", " ", "from", " ", "the", " ", "end"}], " ", "*)"}], 
            " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"usingLec1", ",", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[GreaterEqual]", " ", "0.5"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{"dir", " ", "<>", " ", "\"\</usingLEC1.csv\>\""}],
                     "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                   "First"}], ")"}]}], ",", " ", 
                RowBox[{"-", "len"}]}], "]"}]}], " ", "]"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"cutting", " ", "lec1", " ", "short"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "getting", " ", "and", " ", "filtering", " ", "the", " ", "rest",
               " ", "of", " ", "the", " ", "data"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"trueYs", ",", 
              RowBox[{"Pick", "[", 
               RowBox[{"trueYsTemp", ",", 
                RowBox[{"usingLec1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
            " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "the", " ", "shortest", " ", "trace", " ", "we", " ", "have"}], 
              ",", " ", "filtering"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"tcRange", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                   "dir", " ", "<>", " ", "\"\</TCGTPipeRange.csv\>\""}], 
                   "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                 "First"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"trueHeads", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Pick", "[", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    "dir", " ", "<>", " ", "\"\</TCGTPipeHeading.csv\>\""}], 
                    "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                    "First"}], ",", " ", 
                    RowBox[{"-", "len"}]}], "]"}], ",", 
                  RowBox[{"usingLec1", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "*", 
               RowBox[{"180", "/", "Pi"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pfRanges", ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{"dir", " ", "<>", " ", "\"\</pfRanges.csv\>\""}], 
                    "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                   "First"}], ",", " ", 
                  RowBox[{"-", "len"}]}], "]"}], ",", 
                RowBox[{"usingLec1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pfHeadings", ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    "dir", " ", "<>", " ", "\"\</pfHeadings.csv\>\""}], "]"}],
                     " ", "//", " ", "Transpose"}], " ", "//", " ", "First"}],
                   ",", " ", 
                  RowBox[{"-", "len"}]}], "]"}], ",", 
                RowBox[{"usingLec1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], 
               RowBox[{"(*", 
                RowBox[{"already", " ", "in", " ", "degrees"}], "*)"}], " ", 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pfYs", ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{"dir", " ", "<>", " ", "\"\</pf_ys.csv\>\""}], 
                    "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                   "First"}], ",", " ", 
                  RowBox[{"-", "len"}]}], "]"}], ",", 
                RowBox[{"usingLec1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"pipedist", ",", " ", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"tcRange", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "*", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"tcHead", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], " ", 
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "keeping", " ", "this", " ", "just", " ", "for", " ", "the", 
               " ", "company"}], ",", " ", 
              RowBox[{"actually", " ", "using", " ", "safeties"}]}], " ", 
             "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"uuvSafe", ",", " ", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"trueYs", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "]"}], " ", 
               "\[GreaterEqual]", " ", "10"}]}], "]"}], ";", "  ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"particles", ":", "  ", "\[IndentingNewLine]", 
               RowBox[{
               "the", " ", "first", " ", "three", " ", "numbers", " ", "are", 
                " ", "the", " ", "global", " ", "x"}]}], ",", "y", ",", 
              RowBox[{
              "theta", " ", "coordinates", " ", "of", " ", "the", " ", 
               "particle", "\n", "the", " ", "next", " ", "4", " ", 
               RowBox[{"(", 
                RowBox[{"3", "-", "6"}], ")"}], " ", "are", " ", "the", " ", 
               "linear", " ", "model", " ", "states", " ", 
               RowBox[{"(", "edited", ")"}], "\n", "the", " ", "7", "th", " ",
                "entry", " ", "is", " ", "the", " ", "global", " ", "offset", 
               " ", "of", " ", "the", " ", "particle", " ", "heading", " ", 
               "and", " ", "the", " ", "8", "th", " ", "entry", " ", "is", 
               " ", "the", " ", "local", " ", "heading", " ", "of", " ", 
               "the", " ", "particle", "\[IndentingNewLine]", "I", " ", 
               "want", " ", "the", " ", "2", "nd", " ", "for", " ", "Ys"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"and", " ", "7", "th"}], "+", 
               RowBox[{"8", "th", " ", "for", " ", "the", " ", "heading", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "need", " ", "to", " ", "check", " ", "the", " ", "sign"}], 
                  ",", " ", 
                  "\"\<those are headings of the uuv, not headings of the \
pipe wrt the uuv\>\""}], ")"}]}]}]}], "\[IndentingNewLine]", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"particlesFiles", " ", "=", " ", 
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"FileNames", "[", 
                RowBox[{"All", ",", 
                 RowBox[{"dir", "<>", "\"\</particles\>\""}]}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"-", "4"}]}], "]"}], "==", " ", "\"\<.csv\>\""}], 
                "&"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "focusing", " ", "on", " ", "the", " ", "last", " ", "so"}], 
              "-", 
              RowBox[{"many", " ", "particle", " ", "files"}]}], " ", "*)"}], 
            " ", "\[IndentingNewLine]", 
            RowBox[{"particleFileIDs", "=", " ", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", "particlesFiles"}], "-", "len"}], ",", 
               " ", 
               RowBox[{
                RowBox[{"Length", "@", "particlesFiles"}], "-", "1"}]}], 
              "]"}]}], ";", "  ", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"string", " ", "-", 
              RowBox[{
              "based", " ", "parsing", " ", "of", " ", "particles"}]}], " ", 
             "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"particles", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"ImportString", "[", 
                    RowBox[{"#", ",", " ", "\"\<Table\>\""}], "]"}], "&"}], "/@",
                    " ", 
                   RowBox[{"(", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringSplit", "/@", " ", 
                    RowBox[{"(", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{"dir", "<>", "\"\</particles/particlesIter\>\"", "<>", 
                    RowBox[{"ToString", "@", "#"}], "<>", "\"\<.csv\>\""}], 
                    "]"}], " ", "//", "First"}], ")"}]}], 
                    "\[IndentingNewLine]", "//", "First"}], ")"}], ")"}]}], 
                  "&"}], "/@", " ", "particleFileIDs"}]}], "]"}], ";"}], 
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"particles", ",", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Import", "[", 
                 RowBox[{
                  RowBox[{"dir", "<>", "\"\</particles/particlesIter\>\"", "<>", 
                   RowBox[{"ToString", "@", "#"}], "<>", "\"\<.csv\>\""}], 
                  ",", " ", "\"\<Table\>\"", ",", 
                  RowBox[{
                  "\"\<FieldSeparators\>\"", "\[Rule]", "\"\<,\>\""}]}], 
                 "]"}], "&"}], "/@", " ", "particleFileIDs"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"2", "nd", " ", 
              RowBox[{"item", ":", " ", 
               RowBox[{
                RowBox[{"particle", "'"}], "s", " ", "Y", " ", 
                "position"}]}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"particleYs", ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"particles", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "All", ",", "All", ",", "2"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"usingLec1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], " ", 
            ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"particleHeads", ",", 
                RowBox[{
                 RowBox[{"Pick", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"particles", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", "All", ",", "7"}], 
                    "]"}], "]"}], " ", "+", 
                    RowBox[{"particles", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", "All", ",", "8"}], 
                    "]"}], "]"}]}], ",", 
                   RowBox[{"usingLec1", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], " ", "*", 
                 RowBox[{"180", "/", "Pi"}]}]}], " ", "]"}], " ", ";"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"particleHeads", ",", 
              RowBox[{
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"particles", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "All", ",", "All", ",", "3"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{"usingLec1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"180", "/", "Pi"}]}]}], "]"}], " ", ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"calculating", " ", "pipeY"}], ",", " ", 
              RowBox[{"then", " ", "figuring", " ", "out", " ", "the", " ", 
               RowBox[{"particle", "'"}], "s", " ", "distance"}]}], " ", 
             "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"pipeYs", " ", "=", "  ", 
             RowBox[{
              RowBox[{"pfYs", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}], "+", 
              RowBox[{"Map", "[", 
               RowBox[{"Mean", ",", " ", 
                RowBox[{"particleYs", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"particleDists", ",", 
              RowBox[{"pipeYs", "-", " ", 
               RowBox[{"particleYs", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"times", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Import", "[", 
                 RowBox[{"dir", " ", "<>", " ", "\"\</times.csv\>\""}], "]"}],
                 " ", "//", " ", "Transpose"}], " ", "//", " ", "First"}]}], 
             "]"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"for", " ", "sanity", " ", "checking", " ", "only"}], 
             " ", "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{"times", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "]"}], " ", "<", "  ", 
                "1"}], " ", "\[Or]", " ", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{"times", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "\[GreaterEqual]",
                 " ", "4"}]}], ",", " ", 
              RowBox[{"PrintTemporary", "[", 
               RowBox[{"\"\<Weird time interval found:\>\"", ",", 
                RowBox[{"times", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", "dir"}], 
               "]"}]}], "  ", "]"}], ";", " ", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"one", " ", "per", " ", "trace"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"findist", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[GreaterEqual]", " ", "0.5"}], "&"}], "@", 
               RowBox[{
                RowBox[{"Import", "[", 
                 RowBox[{"dir", "<>", "\"\</initData.csv\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"(*", 
                  RowBox[{"third", " ", "line"}], " ", "*)"}], 
                 RowBox[{"3", ",", 
                  RowBox[{"(*", 
                   RowBox[{"1", "st", " ", 
                    RowBox[{"element", ":", " ", 
                    RowBox[{"fin", " ", "disturbance"}]}]}], " ", "*)"}], 
                  "1"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"trialDirs", "[", 
         RowBox[{"[", "idx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "safeties", " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"uuvSafeties", " ", "=", " ", 
        RowBox[{"computeUuvSafeties", "[", "trueYs", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"pair", " ", "up", " ", "particles"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"particleYHpairs", " ", "=", "  ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"particleDists", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
             RowBox[{"particleHeads", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "particleDists"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", " ", 
            RowBox[{"Length", "@", 
             RowBox[{"particleDists", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "}"}]}], "]"}]}], ";", 
       
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"works", " ", "only", " ", "for", " ", "same"}], "-", 
         RowBox[{"length", " ", 
          RowBox[{"lists", ":", " ", 
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"particleDists", ",", "particleHeads"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], 
            "]"}]}]}]}], "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"stateMon", " ", "=", " ", 
        RowBox[{"N", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Count", "[", 
              RowBox[{"#", ",", 
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"verifiedUuvStateAll", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], 
                 ")"}]}]}], " ", "]"}], " ", "/", 
             RowBox[{"Length", "@", "#"}]}], " ", "&"}], " ", ",", 
           "particleYHpairs", ",", " ", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], " ", 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"preprocessing", " ", "step"}], ",", " ", 
     RowBox[{"computing", " ", "the", " ", "monitor"}]}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"saveCachedUuvStateMon", "[", " ", 
      RowBox[{"trialDirs_", ",", " ", "stateMonData_"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "trialDirs"}], "!=", " ", 
        RowBox[{"Length", "@", "stateMonData"}]}], ",", " ", 
       RowBox[{"PrintTemporary", "[", "\"\<Mismatched data size\>\"", "]"}], 
       ",", " ", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"#", "<>", "\"\</stateMon.csv\>\""}], ",", " ", 
            RowBox[{"stateMonData", "[", 
             RowBox[{"[", 
              RowBox[{"First", "@", 
               RowBox[{"FirstPosition", "[", 
                RowBox[{"trialDirs", ",", "#"}], "]"}]}], "]"}], "]"}]}], " ",
            "]"}], "\[IndentingNewLine]", ")"}], "&"}], "/@", "trialDirs"}]}],
       " ", "\[IndentingNewLine]", "]"}]}], ";"}], " ", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeUuvSafeties", "[", "trueYs_", "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"trace", " ", "=", " ", "#"}], "}"}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", "#", "]"}], " ", "\[GreaterEqual]", " ", 
             "10"}], "&"}], "/@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"trace", "[", 
              RowBox[{"[", 
               RowBox[{"i", ";;"}], "]"}], "]"}], ",", "  ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "1", ",", " ", 
               RowBox[{"Length", "@", "trace"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], "/@", " ", "trueYs"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "only", " ", "loads", " ", "what", " ", "is", " ", "sufficient", " ", 
     "for", " ", "the", " ", "experiments"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadSomeUuvData", "[", 
      RowBox[{"idx_", ",", " ", "mgStepSize_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"first", ",", " ", 
        RowBox[{"individual", " ", "data"}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tcRange", "=", " ", 
         RowBox[{"{", "}"}]}], ";"}], "*)"}], " ", 
      RowBox[{
       RowBox[{"trueHeads", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"usingLec1", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"times", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"pipedist", "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], 
       RowBox[{"findist", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"trueYs", "=", 
        RowBox[{"{", "}"}]}], ";", "  ", 
       RowBox[{"pfYs", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"pfRanges", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"pfHeadings", " ", "=", " ", 
        RowBox[{"{", "}"}]}], " ", ";", 
       RowBox[{"particles", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"particleYs", "=", 
        RowBox[{"{", "}"}]}], ";", "  ", 
       RowBox[{"particleHeads", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", " ", 
       RowBox[{"particleDists", "=", " ", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"stateMonLoaded", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"uuvSafe", "=", 
        RowBox[{"{", "}"}]}], ";", "   ", "\[IndentingNewLine]", 
       RowBox[{"mgUuvCons", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"mgUuvRawConfs", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"stateAssns", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"trueHeads", "=", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dir", "=", "#"}], "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"mg", " ", "data", " ", 
             RowBox[{"reading", " ", "--"}], " ", "the", " ", "shortest", " ",
              "TODO", " ", "add", " ", "to", " ", "full", " ", "data", " ", 
             "reading"}], "*)"}], " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"imp", " ", "=", " ", 
                RowBox[{"Import", "[", " ", 
                 RowBox[{"dir", "<>", "\"\</mg.csv\>\""}], "]"}]}], " ", 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"mgUuvCons", ",", " ", 
                 RowBox[{"imp", "[", 
                  RowBox[{"[", 
                   RowBox[{"(*", 
                    RowBox[{"all", " ", "but", " ", "first", " ", "line"}], 
                    " ", "*)"}], " ", 
                   RowBox[{
                    RowBox[{"2", ";;"}], " ", ",", 
                    RowBox[{"(*", 
                    RowBox[{"2", "nd", " ", 
                    RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "it", " ", "was", " ", "deemed", " ", 
                    "consistent"}]}]}], " ", "*)"}], " ", "2"}], "]"}], 
                  "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"mgUuvRawConfs", ",", " ", 
                 RowBox[{"imp", "[", 
                  RowBox[{"[", 
                   RowBox[{"(*", 
                    RowBox[{"all", " ", "but", " ", "first", " ", "line"}], 
                    " ", "*)"}], " ", 
                   RowBox[{
                    RowBox[{"2", ";;"}], " ", ",", 
                    RowBox[{"(*", 
                    RowBox[{"2", "nd", " ", 
                    RowBox[{"element", ":", " ", 
                    RowBox[{
                    "whether", " ", "it", " ", "was", " ", "deemed", " ", 
                    "consistent"}]}]}], " ", "*)"}], " ", "3"}], "]"}], 
                  "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], " ", 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
               "need", " ", "processing", " ", "to", " ", "demolish", " ", 
                "non"}], "-", 
               RowBox[{"using", " ", "lec"}]}], ",", " ", 
              RowBox[{"0", "-", 
               RowBox[{"line", " ", "crossing"}]}], ",", " ", 
              RowBox[{
              "and", " ", "other", " ", "questionable", " ", "things"}]}], 
             " ", "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"trueYsTemp", " ", "=", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{"dir", " ", "<>", " ", "\"\</uv_ys.csv\>\""}], 
                   "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                 "First"}], ")"}]}], ";"}], "*)"}], " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "just", " ", "to", " ", "know", " ", "the", " ", "length"}], " ",
              "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"len", "=", 
             RowBox[{"Length", "@", 
              RowBox[{"mgUuvCons", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}]}], " ", ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "the", " ", "number", " ", "of", " ", "meaningful", " ", 
               "samples", " ", "from", " ", "the", " ", "end"}], ",", " ", 
              RowBox[{
              "TODO", " ", "add", " ", "mg", " ", "step", " ", "size", " ", 
               "to", " ", "loading", " ", "all", " ", "data"}]}], " ", "*)"}],
             " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"usingLec1", ",", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[GreaterEqual]", " ", "0.5"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{"dir", " ", "<>", " ", "\"\</usingLEC1.csv\>\""}],
                     "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                   "First"}], ")"}]}], ",", " ", 
                RowBox[{"-", "len"}]}], "]"}]}], "]"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"cutting", " ", "lec1", " ", "short"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "getting", " ", "and", " ", "filtering", " ", "the", " ", "rest",
               " ", "of", " ", "the", " ", "data"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"trueYs", ",", 
              RowBox[{"Pick", "[", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{"(*", "trueYsTemp", "*)"}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{"dir", " ", "<>", " ", "\"\</uv_ys.csv\>\""}], 
                    "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                   "First"}], ",", " ", 
                  RowBox[{"-", "len"}]}], "]"}], ",", 
                RowBox[{"usingLec1", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
            " ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "the", " ", "shortest", " ", "trace", " ", "we", " ", "have"}], 
              ",", " ", "filtering"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"trueHeads", ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Pick", "[", 
                 RowBox[{
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Import", "[", 
                    RowBox[{
                    "dir", " ", "<>", " ", "\"\</TCGTPipeHeading.csv\>\""}], 
                    "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                    "First"}], ",", " ", 
                    RowBox[{"-", "len"}]}], "]"}], ",", 
                  RowBox[{"usingLec1", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "*", 
               RowBox[{"180", "/", "Pi"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "keeping", " ", "this", " ", "just", " ", "for", " ", "the", 
               " ", "company"}], ",", " ", 
              RowBox[{
              "does", " ", "not", " ", "have", " ", "any", " ", "effect"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"we", "'"}], "re", " ", "actually", " ", "using", " ", 
               "safeties"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"uuvSafe", ",", " ", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"trueYs", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "]"}], " ", 
               "\[GreaterEqual]", " ", "10"}]}], "]"}], ";", "  ", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "no", " ", "need", " ", "for", " ", "cutting", " ", "because", 
              " ", 
              RowBox[{"it", "'"}], "s", " ", "already", " ", 
              RowBox[{"cut", " ", "--"}], " ", "except", " ", "for", " ", 
              "the", " ", "MG", " ", "restriction"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"stateMonLoaded", "=", " ", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"stateMonLoaded", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Import", "[", 
                    RowBox[{"dir", " ", "<>", " ", "\"\</stateMon.csv\>\""}], 
                    "]"}], " ", "//", " ", "Transpose"}], " ", "//", " ", 
                  "First"}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"mgStepSize", ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
            " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"Once", " ", "per", " ", 
              RowBox[{"trace", " ", ":"}]}], "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "state", " ", "assn", " ", "calculation", " ", "TODO", " ", 
              "add", " ", "to", " ", "full", " ", "data", " ", "reading"}], 
             "*)"}], " ", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stateAssns", " ", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"verifiedUuvStateAll", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "&"}], "/@", 
               " ", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"trueYs", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}], ",", " ", 
                  RowBox[{"trueHeads", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}], " ",
              "]"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"fine", " ", "disturbance"}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"findist", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[GreaterEqual]", " ", "0.5"}], "&"}], "@", 
               RowBox[{
                RowBox[{"Import", "[", 
                 RowBox[{"dir", "<>", "\"\</initData.csv\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"(*", 
                  RowBox[{"third", " ", "line"}], " ", "*)"}], 
                 RowBox[{"3", ",", 
                  RowBox[{"(*", 
                   RowBox[{"1", "st", " ", 
                    RowBox[{"element", ":", " ", 
                    RowBox[{"fin", " ", "disturbance"}]}]}], " ", "*)"}], 
                  "1"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"trialDirs", "[", 
         RowBox[{"[", "idx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "safeties", " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"uuvSafeties", " ", "=", " ", 
        RowBox[{"computeUuvSafeties", "[", "trueYs", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "transforming", " ", "mg", " ", "confidences", " ", "to", " ", "1"}],
          "-", 
         RowBox[{"rawconf", " ", "when", " ", "not", " ", "consistent"}]}], 
        " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"mgUuvConfs", " ", "=", " ", 
        RowBox[{"Table", "[", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"mgUuvCons", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "\[Equal]", " ", 
               "1"}], ",", " ", 
              RowBox[{"mgUuvRawConfs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", " ", 
              RowBox[{"1", "-", " ", 
               RowBox[{"mgUuvRawConfs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "]"}], 
            "\[IndentingNewLine]", ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "@", 
               RowBox[{"mgUuvCons", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], 
          "\[IndentingNewLine]", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "@", "mgUuvCons"}]}], "}"}]}], "]"}]}], " ", 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"cutting", " ", "these", " ", "traces", " ", "short"}], " ", 
         "-", " ", 
         RowBox[{"TEST", " ", "ONLY"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"cutLen", " ", "=", "20"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"uuvSafeties", "=", "  ", 
        RowBox[{"uuvSafeties", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", 
           RowBox[{";;", "cutLen"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"stateAssns", "=", " ", 
        RowBox[{"stateAssns", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", 
           RowBox[{";;", "cutLen"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"stateMonLoaded", "=", " ", 
        RowBox[{"stateMonLoaded", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", 
           RowBox[{";;", "cutLen"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mgUuvConfs", "=", 
        RowBox[{"mgUuvConfs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", 
           RowBox[{";;", "cutLen"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"adding", " ", "noise", " ", "to", " ", "state", " ", "mon"}],
         " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"stateMonLoaded", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "*", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.01", ",", "0.99"}], "}"}], "]"}]}], "+", 
                RowBox[{"RandomReal", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "0.35"}], ",", "0.35"}], "}"}], "]"}]}], ",", 
               "0"}], "]"}], ",", "1"}], "]"}], "&"}], ",", "stateMonLoaded", 
          ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "pairs", " ", "up", " ", "and", " ", "cleans", " ", "up", " ", "the", 
      " ", "mountain", " ", "car", " ", "data", " ", "into", " ", "the", " ", 
      "standard", " ", "vars", "\[IndentingNewLine]", "assumes", " ", "that", 
      " ", "both", " ", "assumptions", " ", "are", " ", "once"}], "-", "per", 
     "-", "run"}], "\[IndentingNewLine]", "*)"}], " ", "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"organizeMcData", "[", 
      RowBox[{
      "outcomes_", ",", " ", "a1s_", ",", " ", "a2s_", ",", " ", "m1s_", ",", 
       " ", "m2s_"}], "]"}], " ", ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"outA1Pairs", " ", "=", " ", 
         RowBox[{"Inner", "[", 
          RowBox[{"List", ",", " ", 
           RowBox[{"ToExpression", "/@", "outcomes"}], ",", 
           RowBox[{"ToExpression", "/@", "a1s"}], ",", "  ", "List"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"outA2Pairs", " ", "=", " ", 
         RowBox[{"Inner", "[", 
          RowBox[{"List", ",", " ", 
           RowBox[{"ToExpression", "/@", "outcomes"}], ",", 
           RowBox[{"ToExpression", "/@", "a2s"}], ",", "  ", "List"}], 
          "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"outA1andA2Pairs", " ", "=", " ", 
         RowBox[{"Inner", "[", 
          RowBox[{"List", ",", " ", 
           RowBox[{"ToExpression", "/@", "outcomes"}], ",", 
           RowBox[{"ToExpression", "/@", "a1AndA2Holds"}], ",", "  ", 
           "List"}], "]"}]}], ";"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"outOneAssnHolds", " ", "=", "  ", 
         RowBox[{"Inner", "[", 
          RowBox[{"List", ",", " ", 
           RowBox[{"ToExpression", "/@", "outcomes"}], ",", 
           RowBox[{"ToExpression", "/@", "a1OrA2s"}], ",", "  ", "List"}], 
          "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"monitor", " ", "\[Rule]", " ", "outcome"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outM1Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"pairElemWithList", "/@", " ", 
            RowBox[{"Inner", "[", 
             RowBox[{
             "List", ",", "  ", "outcomes", ",", "m1s", ",", " ", "List"}], 
             "]"}]}], " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outM2Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "@", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"pairElemWithList", "/@", " ", 
            RowBox[{"Inner", "[", 
             RowBox[{
             "List", ",", "  ", "outcomes", ",", "m2s", ",", " ", "List"}], 
             "]"}]}], " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"monitor", " ", "\[Rule]", " ", 
         RowBox[{"its", " ", "assn"}]}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"a1M1Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"pairElemWithList", "/@", " ", 
            RowBox[{"Inner", "[", 
             RowBox[{"List", ",", "  ", "a1s", ",", "m1s", ",", " ", "List"}],
              "]"}]}], " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a2M2Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"pairElemWithList", "/@", " ", 
            RowBox[{"Inner", "[", 
             RowBox[{"List", ",", "  ", "a2s", ",", "m2s", ",", " ", "List"}],
              "]"}]}], " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"monitor", " ", "\[Rule]", " ", 
         RowBox[{"all", " ", "assn"}]}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"allAssnMcPairs", " ", "=", "  ", 
          RowBox[{"fixExtremeProbs", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"pairElemWithList", "/@", " ", 
              RowBox[{"Inner", "[", 
               RowBox[{
               "List", ",", "  ", "allAssnHolds", ",", "mcProbs", ",", " ", 
                "List"}], "]"}]}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"allAssnMgPairs", " ", "=", " ", 
          RowBox[{"fixExtremeProbs", "@", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"pairElemWithList", "/@", " ", 
              RowBox[{"Inner", "[", 
               RowBox[{
               "List", ",", "  ", "allAssnHolds", ",", "mgConfs", ",", " ", 
                "List"}], "]"}]}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"doing", " ", "this", " ", "for", " ", "bayesian"}], " ", 
        "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"m1sByRun", " ", "=", " ", "m1s"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m2sByRun", " ", "=", " ", "m2s"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m1M2sByRun", " ", "=", " ", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"m1s", ",", " ", "m2s"}], "}"}]}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"a1AndA2ByPoint", " ", "=", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[And]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "@", 
               RowBox[{"a1M1Pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"ToExpression", "@", 
               RowBox[{"a2M2Pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "}"}]}]}], 
          ")"}], "  ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"True", "\[Rule]", "\"\<True\>\""}], ",", " ", 
           RowBox[{"False", "\[Rule]", "\"\<False\>\""}]}], "}"}]}]}], " ", 
       ";"}], " ", "\[IndentingNewLine]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "pairs", " ", "up", " ", "and", " ", "cleans", " ", "up", " ", "the", 
       " ", "uuv", " ", "data", " ", "into", " ", "the", " ", "standard", " ",
        "vars", "\[IndentingNewLine]", "assumes", " ", "that", " ", "the", 
       " ", "first", " ", "assumption", " ", "is", " ", "once"}], "-", "per", 
      "-", "step"}], ",", " ", 
     RowBox[{
      RowBox[{"the", " ", "second", " ", "one", " ", "is", " ", "once"}], "-",
       "per", "-", "run"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"organizeUuvData", "[", 
      RowBox[{"safeties_", 
       RowBox[{"(*", "outcomes_", "*)"}], ",", " ", "a1s_", ",", " ", "a2s_", 
       ",", " ", "m1s_", ",", " ", "m2s_"}], "]"}], " ", ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"worked", " ", "for", " ", "per"}], "-", 
        RowBox[{"trace", " ", "safety"}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"outM1Pairs", " ", "=", 
         RowBox[{"fixExtremeProbs2", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"pairElemWithList", "/@", " ", 
             RowBox[{"Inner", "[", 
              RowBox[{
              "List", ",", "  ", "outcomes", ",", "m1s", ",", " ", "List"}], 
              "]"}]}], " ", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outM2Pairs", " ", "=", " ", 
         RowBox[{"fixExtremeProbs2", "@", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"pairElemWithList", "/@", " ", 
             RowBox[{"Inner", "[", 
              RowBox[{
              "List", ",", "  ", "outcomes", ",", "m2s", ",", " ", "List"}], 
              "]"}]}], " ", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"for", " ", "safeties"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"outM1Pairs", " ", "=", 
        RowBox[{"fixExtremeProbs2", "[", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Flatten", "@", " ", "safeties"}], ",", 
            RowBox[{"Flatten", "@", "m1s"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outM2Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "[", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Flatten", "@", " ", "safeties"}], ",", 
            RowBox[{"Flatten", "@", "m2s"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"monitor", " ", "\[Rule]", " ", 
         RowBox[{"its", " ", "assn"}]}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"a1M1Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "[", 
         RowBox[{"Transpose", "@", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Flatten", "@", " ", "a1s"}], ",", 
            RowBox[{"Flatten", "@", "m1s"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a2M2Pairs", " ", "=", " ", 
        RowBox[{"fixExtremeProbs2", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"pairElemWithList", "/@", " ", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{"Not", "/@", "findist"}], ",", "mgUuvConfs"}], 
              "}"}]}]}], " ", ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
        "old", " ", "version", " ", "but", " ", "equivalent", " ", "unless", 
         " ", "all", " ", "traces", " ", "are", " ", "same", " ", "length"}], 
        " ", "*)"}], " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"fixExtremeProbs2", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"pairElemWithList", "/@", " ", 
             RowBox[{"Inner", "[", 
              RowBox[{
              "List", ",", "  ", "a2s", ",", "m2s", ",", " ", "List"}], 
              "]"}]}], " ", ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"monitor", " ", "\[Rule]", " ", 
         RowBox[{"all", " ", "assn"}]}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"allAssnMcPairs", " ", "=", "  ", 
          RowBox[{"fixExtremeProbs", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"pairElemWithList", "/@", " ", 
              RowBox[{"Inner", "[", 
               RowBox[{
               "List", ",", "  ", "allAssnHolds", ",", "mcProbs", ",", " ", 
                "List"}], "]"}]}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"allAssnMgPairs", " ", "=", " ", 
          RowBox[{"fixExtremeProbs", "@", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"pairElemWithList", "/@", " ", 
              RowBox[{"Inner", "[", 
               RowBox[{
               "List", ",", "  ", "allAssnHolds", ",", "mgConfs", ",", " ", 
                "List"}], "]"}]}], " ", ",", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"doing", " ", "this", " ", "for", " ", "bayesian"}], " ", 
        "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"m1sByRun", " ", "=", " ", "m1s"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m2sByRun", " ", "=", " ", "m2s"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"m1M2sByRun", " ", "=", " ", 
        RowBox[{"Transpose", "/@", 
         RowBox[{"(", 
          RowBox[{"Transpose", "@", 
           RowBox[{"{", 
            RowBox[{"m1s", ",", " ", "m2s"}], "}"}]}], ")"}]}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"a1AndA2ByPoint", " ", "=", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[And]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ToExpression", "@", 
               RowBox[{"a1M1Pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"ToExpression", "@", 
               RowBox[{"a2M2Pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "}"}]}]}], 
          ")"}], "  ", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"True", "\[Rule]", "\"\<True\>\""}], ",", " ", 
           RowBox[{"False", "\[Rule]", "\"\<False\>\""}]}], "}"}]}]}], " ", 
       ";"}], " ", "\[IndentingNewLine]", ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "produces", " ", "Platt", " ", "calibration", " ", "coefficients"}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calibrateMon", "[", 
      RowBox[{"aMPairs_", ",", "consW_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Minimize", "[", 
        RowBox[{
         RowBox[{"nllNewW", "[", 
          RowBox[{
           RowBox[{"sigPairs", "[", 
            RowBox[{
             RowBox[{"logOddsPairs", "[", "aMPairs", "]"}], ",", " ", "a", 
             ",", " ", "b"}], "]"}], ",", "consW"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "]"}], " ", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"calibrateMon", "[", 
      RowBox[{"aMPairs_", ",", " ", "extraConstr_", ",", "consW_"}], "]"}], ":=",
      " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Minimize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nll", "[", 
            RowBox[{"sigPairs", "[", 
             RowBox[{
              RowBox[{"logOddsPairs", "[", "aMPairs", "]"}], ",", " ", "a", 
              ",", " ", "b"}], "]"}], "]"}], ",", "consW", ",", "  ", 
           "extraConstr"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], "]"}], " ", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[IndentingNewLine]", ")"}]}], ";"}], 
   " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"wrapper", " ", "for", " ", "case"}], "-", "study", "-", 
     RowBox[{"specific", " ", "data", " ", "ops"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadAndOrganizeUuvData", "[", 
      RowBox[{"resultsDir_", ",", " ", "idx_"}], "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loadUuvFilenames", "[", " ", "resultsDir", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadSomeUuvData", "[", 
        RowBox[{"idx", ",", "  ", 
         RowBox[{"(*", 
          RowBox[{"mg", " ", "step", " ", "count"}], "*)"}], " ", "4"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"organizeUuvData", "[", 
        RowBox[{"uuvSafeties", 
         RowBox[{"(*", "uuvSafe", "*)"}], ",", " ", "stateAssns", ",", " ", 
         RowBox[{"Not", "/@", "findist"}], ",", " ", "stateMonLoaded", ",", 
         " ", "mgUuvConfs"}], "]"}], ";"}], " ", "\[IndentingNewLine]", 
      ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"wrapper", " ", "for", " ", "case"}], "-", "study", "-", 
     RowBox[{"specific", " ", "data", " ", "ops"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"loadAndOrganizeMcData", "[", 
      RowBox[{"resultsDir_", ",", " ", "idx_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loadMcFilenames", "[", " ", "resultsDir", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadMcData", "[", 
        RowBox[{"idx", ",", "  ", 
         RowBox[{"(*", 
          RowBox[{"mg", " ", "step", " ", "count"}], "*)"}], " ", "6"}], 
        "]"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"organizeMcData", "[", 
        RowBox[{
        "successes", ",", " ", "noiseAssnHolds", ",", " ", "steepAssnHolds", 
         ",", " ", "mcProbs", ",", " ", "mgConfs"}], "]"}], ";"}], " ", 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "assumes", " ", "all", " ", "data", " ", "is", " ", "loaded", " ", "into",
      " ", "the", " ", "standard", " ", "vars"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"doValidationTuning", "[", 
      RowBox[{"mcOrUuv_", ",", "consW_", ",", "monsOnly_"}], "]"}], ":=", 
     "  ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"get", " ", "calibration", " ", "parameters"}], "*)"}], " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"mcOrUuv", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"mc", " ", "cal"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PrintTemporary", "[", "\"\<Calibrating M1\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"m1CalParams", " ", "=", 
           RowBox[{"calibrateMon", "[", 
            RowBox[{"a1M1Pairs", ",", "consW"}], 
            RowBox[{"(*", 
             RowBox[{",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "100"}], "<", "a", "<", "100"}], "\[And]", " ", 
               RowBox[{
                RowBox[{"-", "100"}], "<", "b", "<", "100"}]}]}], " ", "*)"}],
             "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"PrintTemporary", "[", "\"\<Calibrating M2\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"m2CalParams", " ", "=", 
           RowBox[{"calibrateMon", "[", 
            RowBox[{"a2M2Pairs", ",", " ", "consW"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"(*", " ", 
          RowBox[{"uuv", " ", "cal"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PrintTemporary", "[", "\"\<Calibrating M1\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"m1CalParams", " ", "=", 
           RowBox[{"calibrateMon", "[", 
            RowBox[{"a1M1Pairs", ",", " ", "consW"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"PrintTemporary", "[", "\"\<Calibrating M2\>\"", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"m2CalParams", " ", "=", 
           RowBox[{"(*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "\[Rule]", " ", "1"}], ",", " ", 
              RowBox[{"b", "\[Rule]", "0"}]}], "}"}], "*)"}], 
           RowBox[{"calibrateMon", "[", 
            RowBox[{"a2M2Pairs", ",", " ", "consW"}], 
            RowBox[{"(*", 
             RowBox[{",", "  ", 
              RowBox[{
               RowBox[{"0", "<", "a"}], "\[And]", 
               RowBox[{"0", "<", "b"}]}]}], "*)"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", "monsOnly"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "PrintTemporary", "[", "\"\<Fitting logistic regression\>\"", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "get", " ", "logistic", " ", "regression", " ", "parameters"}], 
           " ", "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"triplesLR", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"ToExpression", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[And]", 
                 RowBox[{"ToExpression", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}], ",", 
               " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
            
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"a1M1Pairs", ",", " ", "a2M2Pairs"}], "}"}], "]"}]}]}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"pairsLR", " ", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"sig", "[", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "*", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "]"}]}], "+", 
                  RowBox[{"b", "*", 
                   RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "]"}]}], "+", 
                  "c"}], "  ", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
            "triplesLR"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"lrParams", " ", "=", " ", 
           RowBox[{
            RowBox[{"Minimize", "[", 
             RowBox[{
              RowBox[{"nllNewW", "[", 
               RowBox[{"pairsLR", ",", "consW"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "doing", " ", "this", " ", "just", " ", "to", " ", "get", " ", 
            "the", " ", "variances", " ", "for", " ", "weighted", " ", 
            "averaging"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"a1M1CalPairs", "=", " ", 
           RowBox[{"sigPairs", "[", 
            RowBox[{
             RowBox[{"logOddsPairs", "[", "a1M1Pairs", "]"}], ",", 
             RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
             RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"outM1CalPairs", "=", " ", 
           RowBox[{"sigPairs", "[", 
            RowBox[{
             RowBox[{"logOddsPairs", "[", "outM1Pairs", "]"}], ",", 
             RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
             RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"a2M2CalPairs", "=", " ", 
           RowBox[{"sigPairs", "[", 
            RowBox[{
             RowBox[{"logOddsPairs", "[", "a2M2Pairs", "]"}], ",", 
             RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
             RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"outM2CalPairs", "=", " ", 
           RowBox[{"sigPairs", "[", 
            RowBox[{
             RowBox[{"logOddsPairs", "[", "outM2Pairs", "]"}], ",", 
             RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
             RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"get", " ", "variances"}], ","}], " ", "*)"}], " ", 
          "\[IndentingNewLine]", 
          RowBox[{"varM1", " ", "=", " ", 
           RowBox[{"Variance", "[", 
            RowBox[{"a1M1CalPairs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"varM2", " ", "=", " ", 
           RowBox[{"Variance", "[", 
            RowBox[{"a2M2CalPairs", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"get", " ", "bayesian", " ", 
            RowBox[{"joints", ":", " ", 
             RowBox[{
             "fitting", " ", "distributions", " ", "to", " ", "joint", " ", 
              "monitors"}]}]}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{
          "PrintTemporary", "[", "\"\<Fitting Bayesian joints\>\"", "]"}], 
          ";", 
          RowBox[{"(*", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"jointSkdAssnSat", "=", " ", 
             RowBox[{"SmoothKernelDistribution", "[", 
              RowBox[{"Transpose", "@", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Pick", "[", 
                   RowBox[{"m1sByRun", ",", 
                    RowBox[{"ToExpression", "@", "a1AndA2Holds"}]}], "]"}]}], 
                 ",", "  ", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Pick", "[", 
                   RowBox[{"m2sByRun", ",", 
                    RowBox[{"ToExpression", "@", "a1AndA2Holds"}]}], 
                   "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"jointSkdAssnNotSat", "=", " ", 
             RowBox[{"SmoothKernelDistribution", "[", 
              RowBox[{"Transpose", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Flatten", "@", " ", 
                  RowBox[{"Pick", "[", 
                   RowBox[{"m1sByRun", ",", 
                    RowBox[{"Not", "/@", 
                    RowBox[{"ToExpression", "@", "a1AndA2Holds"}]}]}], 
                   "]"}]}], ",", "  ", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Pick", "[", 
                   RowBox[{"m2sByRun", ",", 
                    RowBox[{"Not", "/@", 
                    RowBox[{"ToExpression", "@", "a1AndA2Holds"}]}]}], 
                   "]"}]}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
           "*)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"jointSkdAssnSat", "=", " ", 
           RowBox[{"SmoothKernelDistribution", "[", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"Flatten", "@", "m1sByRun"}], ",", 
                 RowBox[{"ToExpression", "@", "a1AndA2ByPoint"}]}], "]"}], 
               ",", "  ", 
               RowBox[{"Pick", "[", 
                RowBox[{
                 RowBox[{"Flatten", "@", "m2sByRun"}], ",", 
                 RowBox[{"ToExpression", "@", "a1AndA2ByPoint"}]}], "]"}]}], 
              "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"jointSkdAssnAll", "=", " ", 
           RowBox[{"SmoothKernelDistribution", "[", "\[IndentingNewLine]", 
            RowBox[{"Transpose", "@", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"Flatten", "@", "m1sByRun"}], ",", "  ", 
               RowBox[{"Flatten", "@", "m2sByRun"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"jointHistAssnSat", " ", "=", " ", 
           RowBox[{"normalizeHist", "@", 
            RowBox[{"HistogramList", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"Pick", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", "m1sByRun"}], ",", 
                   RowBox[{"ToExpression", "@", "a1AndA2ByPoint"}]}], "]"}], 
                 ",", "  ", 
                 RowBox[{"Pick", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", "m2sByRun"}], ",", 
                   RowBox[{"ToExpression", "@", "a1AndA2ByPoint"}]}], "]"}]}],
                 "}"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05", ",", "0.05"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05", ",", "0.05"}], "}"}]}], "}"}], 
              ",", "\"\<Probability\>\""}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"jointHistAssnNotSat", " ", "=", " ", 
           RowBox[{"normalizeHist", "@", 
            RowBox[{"HistogramList", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"Pick", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", "m1sByRun"}], ",", 
                   RowBox[{"Not", "/@", 
                    RowBox[{"ToExpression", "@", "a1AndA2ByPoint"}]}]}], 
                  "]"}], ",", "  ", 
                 RowBox[{"Pick", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "@", "m2sByRun"}], ",", 
                   RowBox[{"Not", "/@", 
                    RowBox[{"ToExpression", "@", "a1AndA2ByPoint"}]}]}], 
                  "]"}]}], "}"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05", ",", "0.05"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05", ",", "0.05"}], "}"}]}], "}"}], 
              ",", "\"\<Probability\>\""}], "]"}]}]}], ";"}]}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"jointHistAll", "=", " ", 
           RowBox[{"normalizeHist", "@", " ", 
            RowBox[{"HistogramList", "[", 
             RowBox[{
              RowBox[{"Transpose", "@", 
               RowBox[{"{", " ", 
                RowBox[{
                 RowBox[{"Flatten", "@", "m1sByRun"}], ",", "  ", 
                 RowBox[{"Flatten", "@", "m2sByRun"}]}], "}"}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05", ",", "0.05"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "1.05", ",", "0.05"}], "}"}]}], "}"}], 
              ",", "\"\<Probability\>\""}], "]"}]}]}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"end", " ", "of", " ", "monsonly"}], "*)"}], " ", 
      "\[IndentingNewLine]", ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "assumes", " ", "all", " ", "data", " ", "is", " ", "loaded", " ", "into",
      " ", "the", " ", "standard", " ", "vars"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"doTesting", "[", "monsOnly_", "]"}], ":=", "  ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "PrintTemporary", "[", "\"\<Calibrating and composing\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"apply", " ", "calibration"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"a1M1CalPairs", "=", " ", 
        RowBox[{"sigPairs", "[", 
         RowBox[{
          RowBox[{"logOddsPairs", "[", "a1M1Pairs", "]"}], ",", 
          RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
          RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outM1CalPairs", "=", " ", 
        RowBox[{"sigPairs", "[", 
         RowBox[{
          RowBox[{"logOddsPairs", "[", "outM1Pairs", "]"}], ",", 
          RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
          RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a2M2CalPairs", "=", " ", 
        RowBox[{"sigPairs", "[", 
         RowBox[{
          RowBox[{"logOddsPairs", "[", "a2M2Pairs", "]"}], ",", 
          RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
          RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outM2CalPairs", "=", " ", 
        RowBox[{"sigPairs", "[", 
         RowBox[{
          RowBox[{"logOddsPairs", "[", "outM2Pairs", "]"}], ",", 
          RowBox[{"a", "/.", "m1CalParams"}], ",", " ", 
          RowBox[{"b", "/.", "m1CalParams"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Composition", " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"compose", " ", "simple", " ", "functions"}], " ", "*)"}], 
       " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "@", "monsOnly"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"a1AndA2ProdComp", " ", "=", 
           RowBox[{"composeMons", "[", 
            RowBox[{
            "a1M1CalPairs", ",", " ", "a2M2CalPairs", ",", " ", "And", ",", 
             " ", "Times"}], "]"}]}], ";", "   ", "\[IndentingNewLine]", 
          RowBox[{"outProdComp", " ", "=", " ", 
           RowBox[{"composeMons", "[", 
            RowBox[{"outM1CalPairs", ",", " ", "outM2CalPairs", ",", 
             RowBox[{"#1", "&"}], ",", " ", "Times"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"a1AndA2AvgComp", " ", "=", 
           RowBox[{"composeMons", "[", 
            RowBox[{
            "a1M1CalPairs", ",", " ", "a2M2CalPairs", ",", " ", "And", ",", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "+", "#2"}], ")"}], "/", "2"}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"outAvgComp", " ", "=", " ", 
           RowBox[{"composeMons", "[", 
            RowBox[{"outM1CalPairs", ",", " ", "outM2CalPairs", ",", 
             RowBox[{"#1", "&"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "+", "#2"}], ")"}], "/", "2"}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1AndA2WeightAvgComp", " ", "=", 
           RowBox[{"composeMons", "[", 
            RowBox[{
            "a1M1CalPairs", ",", " ", "a2M2CalPairs", ",", " ", "And", ",", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "/", "varM1"}], " ", "+", " ", 
                 RowBox[{"#2", "/", "varM2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1", "/", "varM1"}], "+", 
                 RowBox[{"1", "/", "varM2"}]}], ")"}]}], "&"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"outWeightAvgComp", " ", "=", " ", 
           RowBox[{"composeMons", "[", 
            RowBox[{"outM1CalPairs", ",", " ", "outM2CalPairs", ",", 
             RowBox[{"#1", "&"}], ",", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"#1", "/", "varM1"}], " ", "+", " ", 
                 RowBox[{"#2", "/", "varM2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"1", "/", "varM1"}], "+", 
                 RowBox[{"1", "/", "varM2"}]}], ")"}]}], "&"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"a1AndA2CopBounComp", " ", "=", 
           RowBox[{"composeMons", "[", 
            RowBox[{
            "a1M1CalPairs", ",", " ", "a2M2CalPairs", ",", " ", "And", ",", 
             " ", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"0", ",", 
                RowBox[{"#1", "+", "#2", "-", "1"}]}], "]"}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"outCopBounComp", " ", "=", " ", 
           RowBox[{"composeMons", "[", 
            RowBox[{"outM1CalPairs", ",", " ", "outM2CalPairs", ",", 
             RowBox[{"#1", "&"}], ",", " ", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"0", ",", 
                RowBox[{"#1", "+", "#2", "-", "1"}]}], "]"}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"a1AndA2ProdSqComp", " ", "=", 
           RowBox[{"composeMons", "[", 
            RowBox[{
            "a1M1CalPairs", ",", " ", "a2M2CalPairs", ",", " ", "And", ",", 
             " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "*", "#2"}], ")"}], "^", "2"}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"outProdSqComp", " ", "=", " ", 
           RowBox[{"composeMons", "[", 
            RowBox[{"outM1CalPairs", ",", " ", "outM2CalPairs", ",", 
             RowBox[{"#1", "&"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "*", "#2"}], ")"}], "^", "2"}], "&"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"compose", " ", "logistic", " ", "regression"}], ",", " ", 
            RowBox[{"no", " ", "calibration", " ", "here"}]}], " ", "*)"}], 
          " ", "\[IndentingNewLine]", 
          RowBox[{"triplesLR", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{
                 RowBox[{"ToExpression", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "\[And]", 
                 RowBox[{"ToExpression", "@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "]"}], ",", 
               " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
            
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"a1M1Pairs", ",", " ", "a2M2Pairs"}], "}"}], "]"}]}]}], 
          ";", " ", "\[IndentingNewLine]", 
          RowBox[{"a1andA2LrComp", " ", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"sig", "[", " ", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "]"}]}], "+", 
                    RowBox[{"b", "*", 
                    RowBox[{"Log", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "]"}]}], "+", 
                    "c"}], "  ", ",", "1"}], "]"}]}], "}"}], "&"}], "/@", 
              "triplesLR"}], ")"}], "/.", "lrParams"}]}], ";", "  ", 
          "\[IndentingNewLine]", 
          RowBox[{"outLrComp", " ", "=", " ", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"outM1Pairs", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"(", 
               RowBox[{"a1andA2LrComp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}], ")"}]}], "}"}], 
            "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"bayesian", " ", "estimation"}], ",", " ", 
            RowBox[{"no", " ", "calibration"}]}], " ", "*)"}], " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"bayesCompValues", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"applyBayesToRun", "[", 
                RowBox[{
                "0.5", ",", "#", ",", " ", "jointSkdAssnSat", ",", " ", 
                 "jointSkdAssnNotSat"}], "]"}], "&"}], " ", "/@", 
              "m1M2sByRun"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "TODO", " ", "need", " ", "to", " ", "get", " ", "the", " ", 
               "assumption", " ", "composition", " ", "from", " ", 
               "individual", " ", "runs"}], ",", " ", 
              RowBox[{"not", " ", "overall"}]}], " ", "*)"}], " ", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"OLD", ":", " ", "a1andA2BayesComp"}], " ", "=", " ", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"pairElemWithList", "/@", " ", 
                  RowBox[{"Inner", "[", 
                   RowBox[{"List", ",", "  ", 
                    RowBox[{"outA1andA2Pairs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
                    "bayesCompValues", ",", " ", "List"}], "]"}]}], " ", ",", 
                 " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"outBayesComp", " ", "=", " ", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"pairElemWithList", "/@", " ", 
                  RowBox[{"Inner", "[", 
                   RowBox[{"List", ",", "  ", 
                    RowBox[{"outA1andA2Pairs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    "bayesCompValues", ",", " ", "List"}], "]"}]}], " ", ",", 
                 " ", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"a1andA2BayesComp", " ", "=", 
             RowBox[{"Transpose", "@", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[And]", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
                 RowBox[{"Transpose", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ToExpression", "@", 
                    RowBox[{"a1M1Pairs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", " ", 
                    RowBox[{"ToExpression", "@", 
                    RowBox[{"a2M2Pairs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "}"}]}]}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"Flatten", "@", "bayesCompValues"}]}], "}"}]}]}], 
            "  ", ";", "\[IndentingNewLine]", 
            RowBox[{"outBayesComp", " ", "=", " ", 
             RowBox[{"Flatten", "[", "  ", 
              RowBox[{
               RowBox[{"Transpose", "/@", 
                RowBox[{"(", 
                 RowBox[{"Transpose", "@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"outM1Pairs", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
                    "bayesCompValues"}], "}"}]}], ")"}]}], " ", ",", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}], ";"}], "*)"}], " ",
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"bayesCompValuesSkd", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"applyBayesSkd", "[", 
                RowBox[{
                "0.5", ",", "#", ",", " ", "jointSkdAssnSat", ",", 
                 "jointSkdAssnAll"}], "]"}], "&"}], " ", "/@", 
              RowBox[{"(", "m1M2sByRun", ")"}]}]}], ";"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"bayesCompValuesHist", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"applyBayesHist", "[", 
                RowBox[{
                "0.5", ",", "#", ",", " ", "jointHistAssnSat", ",", 
                 "jointHistAll"}], "]"}], "&"}], " ", "/@", 
              RowBox[{"(", "m1M2sByRun", ")"}]}]}], ";"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"bayesCompValuesFix", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"applyBayesFix", "[", 
              RowBox[{
              "0.5", ",", "#", ",", " ", "jointHistAssnSat", ",", 
               "jointHistAssnNotSat"}], "]"}], "&"}], " ", "/@", 
            RowBox[{"(", "m1M2sByRun", ")"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"a1andA2BayesComp", " ", "=", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", " ", 
              RowBox[{"a1AndA2ByPoint", ",", 
               RowBox[{"Flatten", "@", "bayesCompValuesFix"}]}], "}"}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"True", "\[Rule]", "\"\<True\>\""}], ",", " ", 
              RowBox[{"False", "\[Rule]", "\"\<False\>\""}]}], "}"}]}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"outBayesComp", " ", "=", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"outM1Pairs", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"Flatten", "@", "bayesCompValuesFix"}]}], "}"}], "]"}],
             "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"True", "\[Rule]", "\"\<True\>\""}], ",", " ", 
              RowBox[{"False", "\[Rule]", "\"\<False\>\""}]}], "}"}]}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", "\"\<Computing results\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "evaluate", " ", "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"monsOnly", ",", " ", "\[IndentingNewLine]", 
         RowBox[{"calibEvalShort", "/@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "a1M1CalPairs", ",", "\[IndentingNewLine]", "outM1CalPairs", ",", 
            "\[IndentingNewLine]", "a2M2CalPairs", ",", " ", 
            "\[IndentingNewLine]", "outM2CalPairs"}], "\[IndentingNewLine]", 
           "}"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"calibEvalShort", "/@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "a1M1CalPairs", ",", "\[IndentingNewLine]", "outM1CalPairs", ",", 
            "\[IndentingNewLine]", "a2M2CalPairs", ",", " ", 
            "\[IndentingNewLine]", "outM2CalPairs", ",", 
            "\[IndentingNewLine]", "a1AndA2ProdComp", ",", 
            "\[IndentingNewLine]", "outProdComp", ",", "\[IndentingNewLine]", 
            "a1AndA2ProdSqComp", ",", "\[IndentingNewLine]", "outProdSqComp", 
            ",", "\[IndentingNewLine]", "a1AndA2AvgComp", ",", " ", 
            "\[IndentingNewLine]", "outAvgComp", ",", "\[IndentingNewLine]", 
            "a1AndA2WeightAvgComp", ",", "\[IndentingNewLine]", 
            "outWeightAvgComp", ",", "\[IndentingNewLine]", 
            "a1AndA2CopBounComp", ",", " ", "\[IndentingNewLine]", 
            "outCopBounComp", ",", "\[IndentingNewLine]", "a1andA2LrComp", 
            ",", "\[IndentingNewLine]", "outLrComp", ",", 
            "\[IndentingNewLine]", "a1andA2BayesComp", ",", 
            "\[IndentingNewLine]", "outBayesComp"}], "\[IndentingNewLine]", 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      ")"}]}], ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "runs", " ", "a", " ", "single", " ", "validation", " ", "run", " ", "of",
      " ", "MC", " ", "monitors"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"validateAndTestMcMons", "[", 
      RowBox[{
      "resultsDir_", ",", " ", "valIdx_", ",", "testIdx_", ",", "consW_", ",",
        "monsOnly_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1", "st", " ", 
        RowBox[{"part", ":", " ", "validation"}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", "\"\<Loading data\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadAndOrganizeMcData", "[", 
        RowBox[{"resultsDir", ",", " ", "valIdx"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"doValidationTuning", "[", 
        RowBox[{"True", ",", " ", "consW", ",", " ", "monsOnly"}], "]"}], ";",
        " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"2", "nd", " ", 
         RowBox[{"part", ":", " ", "testing"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", "\"\<Reloading data\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadAndOrganizeMcData", "[", 
        RowBox[{"resultsDir", ",", " ", "testIdx"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"doTesting", "[", "monsOnly", "]"}]}], "\[IndentingNewLine]", 
      ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "runs", " ", "a", " ", "single", " ", "validation", " ", "run", " ", "of",
      " ", "MC", " ", "monitors"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"validateAndTestUuvMons", "[", 
      RowBox[{
      "resultsDir_", ",", " ", "valIdx_", ",", "testIdx_", ",", "consW_", ",",
        "monsOnly_"}], "]"}], ":=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"1", "st", " ", 
        RowBox[{"part", ":", " ", "validation"}]}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", "\"\<Loading data\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadAndOrganizeUuvData", "[", 
        RowBox[{"resultsDir", ",", " ", "valIdx"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"doValidationTuning", "[", 
        RowBox[{"False", ",", "consW", ",", "monsOnly"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"2", "nd", " ", 
         RowBox[{"part", ":", " ", "testing"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", "\"\<Reloading data\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loadAndOrganizeUuvData", "[", 
        RowBox[{"resultsDir", ",", " ", "testIdx"}], "]"}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"doTesting", "[", "monsOnly", "]"}]}], "\[IndentingNewLine]", 
      ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"addHeadingsToResultsMatrix", "[", "mat_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Insert", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"add", " ", "row", " ", "of", " ", "column", " ", "titles"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"(*", " ", 
          RowBox[{
          "add", " ", "column", " ", "of", " ", "method", " ", "titles"}], 
          " ", "*)"}], 
         RowBox[{
          RowBox[{"Partition", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<M1-assn\>\"", ",", " ", "\"\<M1-outcome\>\"", ",", " ", 
              "\"\<M2-assn\>\"", ",", " ", "\"\<M2-outcome\>\"", ",", 
              "\"\<Prod-assn\>\"", ",", " ", "\"\<ProdSq-assn\>\"", ",", " ", 
              "\"\<ProdSq-outcome\>\"", ",", " ", "\"\<Prod-outcome\>\"", ",",
               " ", "\"\<Avg-assn\>\"", ",", " ", "\"\<Avg-outcome\>\"", ",", 
              "\"\<AvgVar-assn\>\"", ",", " ", "\"\<AvgVar-outcome\>\"", ",", 
              " ", "\"\<LowCop-assn\>\"", ",", " ", "\"\<LowCop-outcome\>\"", 
              ",", " ", "\"\<LR-assn\>\"", ",", " ", "\"\<LR-outcome\>\"", 
              ",", " ", "\"\<Bayes-assn\>\"", ",", " ", 
              "\"\<Bayes-outcome\>\""}], "}"}], ",", "1"}], "]"}], ",", 
          "\[IndentingNewLine]", "mat", "\[IndentingNewLine]", ",", "2"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", " ", 
         RowBox[{
         "\"\<Method\>\"", ",", " ", "\"\<ECE\>\"", ",", "\"\<MCE\>\"", ",", 
          " ", "\"\<CCE\>\"", ",", " ", "\"\<Brier\>\"", ",", " ", 
          "\"\<AUC\>\""}], "}"}], ",", "1"}], "]"}], " ", "//", 
      "MatrixForm"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"addMonHeadingsToResultsMatrix", "[", "mat_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Insert", "[", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"add", " ", "row", " ", "of", " ", "column", " ", "titles"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"(*", " ", 
          RowBox[{
          "add", " ", "column", " ", "of", " ", "method", " ", "titles"}], 
          " ", "*)"}], 
         RowBox[{
          RowBox[{"Partition", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "\"\<M1-assn\>\"", ",", " ", "\"\<M1-outcome\>\"", ",", " ", 
              "\"\<M2-assn\>\"", ",", " ", "\"\<M2-outcome\>\""}], "}"}], ",",
             "1"}], "]"}], ",", "\[IndentingNewLine]", "mat", 
          "\[IndentingNewLine]", ",", "2"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", " ", 
         RowBox[{
         "\"\<Method\>\"", ",", " ", "\"\<ECE\>\"", ",", "\"\<MCE\>\"", ",", 
          " ", "\"\<CCE\>\"", ",", " ", "\"\<Brier\>\"", ",", " ", 
          "\"\<AUC\>\""}], "}"}], ",", "1"}], "]"}], " ", "//", 
      "MatrixForm"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getRandomIdxSplit", "[", 
      RowBox[{"idCount_", ",", " ", "valFrac_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rs", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vals", "=", " ", 
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"Range", "[", "idCount", "]"}], ",", " ", 
           RowBox[{"Round", "[", 
            RowBox[{"valFrac", "*", "idCount"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sort", "@", "vals"}], ",", " ", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Range", "[", "idCount", "]"}], ",", "vals"}], "]"}]}], 
         " ", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "  ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "perform", " ", "the", " ", "given", " ", "number", " ", "of", " ", "MC", 
     " ", "evaluation", " ", "with", " ", "a", " ", "given", " ", 
     "validation", " ", "set", " ", "fraction"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"doMcEvals", "[", 
      RowBox[{
      "resultsDir_", ",", " ", "evalCt_", ",", " ", "valFrac_", ",", "consW_",
        ",", "monsOnly_"}], "]"}], ":=", 
     RowBox[{"(", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loadMcFilenames", "[", " ", "resultsDir", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resMats", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"splitIdx", " ", "=", " ", 
           RowBox[{"getRandomIdxSplit", "[", 
            RowBox[{
             RowBox[{"Length", "@", "outcomeFiles"}], ",", " ", "0.5"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"validateAndTestMcMons", "[", 
            RowBox[{"resultsDir", ",", " ", 
             RowBox[{"splitIdx", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"splitIdx", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "consW", ",", "monsOnly"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"resMats", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"resMats", ",", " ", "res"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", " ", ",", " ", "evalCt"}], "]"}], ";", 
       "\[IndentingNewLine]", "resMats"}], "\[IndentingNewLine]", ")"}]}], 
    ";"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "perform", " ", "the", " ", "given", " ", "number", " ", "of", " ", "UUV",
      " ", "evaluation", " ", "with", " ", "a", " ", "given", " ", 
     "validation", " ", "set", " ", "fraction"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"doUuvEvals", "[", 
      RowBox[{
      "resultsDir_", ",", " ", "evalCt_", ",", " ", "valFrac_", ",", "consW_",
        ",", "monsOnly_"}], "]"}], ":=", 
     RowBox[{"(", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"loadUuvFilenames", "[", " ", "resultsDir", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resMatsUuv", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"splitIdx", " ", "=", " ", 
           RowBox[{"getRandomIdxSplit", "[", 
            RowBox[{
             RowBox[{"Length", "@", "trialDirs"}], ",", " ", "valFrac"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"resUuv", " ", "=", " ", 
           RowBox[{"validateAndTestUuvMons", "[", 
            RowBox[{"resultsDir", ",", " ", 
             RowBox[{"splitIdx", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
             RowBox[{"splitIdx", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "consW", ",", "monsOnly"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"resMatsUuv", ",", " ", "resUuv"}], "]"}], ";"}], 
         "\[IndentingNewLine]", " ", ",", " ", "evalCt"}], "]"}], ";", 
       "\[IndentingNewLine]", "resMatsUuv"}], "\[IndentingNewLine]", ")"}]}], 
    ";"}], " "}]}]], "Input",
 CellChangeTimes->{{3.8387271241146317`*^9, 3.838727142274581*^9}, {
   3.8400399783138323`*^9, 3.840039987014853*^9}, {3.840546834018643*^9, 
   3.840546834159383*^9}, {3.840547535666313*^9, 3.840547612826077*^9}, {
   3.840547677073646*^9, 3.84054771377531*^9}, {3.840548308038787*^9, 
   3.840548431310793*^9}, {3.840551233629573*^9, 3.840551235733914*^9}, {
   3.840551560537537*^9, 3.8405516409364023`*^9}, {3.840551720899835*^9, 
   3.8405517790078287`*^9}, {3.840551815512703*^9, 3.8405518469922943`*^9}, {
   3.840551933578766*^9, 3.840551947462113*^9}, {3.840620797118544*^9, 
   3.840620807703524*^9}, {3.840620955554762*^9, 3.840620990430462*^9}, {
   3.840621338499271*^9, 3.840621459949272*^9}, 3.840621556380662*^9, 
   3.840622224804947*^9, {3.840623760253579*^9, 3.840623785229498*^9}, {
   3.840626295911006*^9, 3.840626320257811*^9}, {3.840626469814515*^9, 
   3.840626473929531*^9}, {3.840626633208096*^9, 3.840626638915536*^9}, {
   3.8406283104824333`*^9, 3.840628323483522*^9}, {3.840634030466663*^9, 
   3.840634066626371*^9}, {3.840635025271183*^9, 3.840635063624483*^9}, {
   3.8407079050274067`*^9, 3.840707905601124*^9}, {3.840711355823915*^9, 
   3.8407113897478848`*^9}, {3.840711431099682*^9, 3.840711440507339*^9}, {
   3.840712323695448*^9, 3.840712324776671*^9}, {3.840712854410378*^9, 
   3.84071286890207*^9}, {3.840713217550585*^9, 3.840713241388626*^9}, {
   3.8407134435528917`*^9, 3.840713448153537*^9}, {3.8407142400590878`*^9, 
   3.840714240569571*^9}, {3.840715071207035*^9, 3.840715072281453*^9}, {
   3.840715126435856*^9, 3.840715127065735*^9}, {3.840715298703782*^9, 
   3.840715308842539*^9}, 3.840715349448001*^9, {3.840715395053887*^9, 
   3.840715395928092*^9}, {3.840715445231214*^9, 3.8407154740679073`*^9}, {
   3.840715515653063*^9, 3.840715551155748*^9}, {3.840715721871459*^9, 
   3.840715741194118*^9}, {3.840896074498109*^9, 3.84089608285641*^9}, {
   3.840898254427684*^9, 3.840898307388596*^9}, {3.8429665689739227`*^9, 
   3.8429665691006317`*^9}, {3.843140374039734*^9, 3.843140407845394*^9}, {
   3.843140472963613*^9, 3.843140491943872*^9}, {3.843404646459499*^9, 
   3.8434046595610332`*^9}, {3.8439456892017117`*^9, 3.843945694348814*^9}, {
   3.8439457774712553`*^9, 3.8439458146748943`*^9}, {3.8439460092113457`*^9, 
   3.8439460159238157`*^9}, {3.844094427758684*^9, 3.8440944964247704`*^9}, {
   3.844096123436079*^9, 3.844096131009231*^9}, {3.844097820908538*^9, 
   3.844097902507949*^9}, {3.844097938830283*^9, 3.8440979646171293`*^9}, {
   3.844100310139901*^9, 3.84410031816809*^9}, {3.844103488194878*^9, 
   3.844103494860293*^9}, {3.844106325925872*^9, 3.84410635366813*^9}, {
   3.84411025174238*^9, 3.8441102534516068`*^9}, {3.844202184733686*^9, 
   3.8442021894884644`*^9}, {3.844258618363049*^9, 3.844258630738264*^9}, {
   3.844259255255625*^9, 3.8442592730805683`*^9}, {3.844259375333475*^9, 
   3.844259376050514*^9}, {3.844259446039873*^9, 3.844259491983642*^9}, {
   3.844343515142671*^9, 3.8443435460873213`*^9}, {3.844347077190648*^9, 
   3.8443470774039917`*^9}, {3.8443505319360743`*^9, 
   3.8443505462264833`*^9}, {3.844351028481545*^9, 3.844351037622957*^9}, 
   3.844352779986924*^9, {3.844353149932967*^9, 3.8443531559224854`*^9}, {
   3.844353880995825*^9, 3.8443539579390507`*^9}, {3.844354013303617*^9, 
   3.844354042402115*^9}, {3.844354136894565*^9, 3.8443541424696293`*^9}, 
   3.844354227452868*^9, {3.844354470802124*^9, 3.84435449856069*^9}, {
   3.844354555905197*^9, 3.844354570707346*^9}, {3.844354698694737*^9, 
   3.844354701455233*^9}, {3.844354737691183*^9, 3.8443547443784237`*^9}, {
   3.844354775782476*^9, 3.844354778390521*^9}, {3.844354878793536*^9, 
   3.84435489588694*^9}, {3.844355089056759*^9, 3.844355097893878*^9}, {
   3.844355142703711*^9, 3.844355151017524*^9}, {3.844355358950282*^9, 
   3.8443554603075523`*^9}, {3.844355573520714*^9, 3.844355594353581*^9}, {
   3.844355689044038*^9, 3.844355706468154*^9}, {3.844356032980756*^9, 
   3.8443561483005466`*^9}, {3.844356309690172*^9, 3.844356310390766*^9}, {
   3.844359925959736*^9, 3.844359926440906*^9}, {3.844360500137459*^9, 
   3.844360553180058*^9}, 3.844360655368774*^9, {3.84436097555383*^9, 
   3.844361054676909*^9}, {3.844361092032258*^9, 3.8443610924865026`*^9}, {
   3.84436272393535*^9, 3.8443628246844797`*^9}, {3.8443630546387577`*^9, 
   3.8443630791252203`*^9}, {3.844363111622322*^9, 3.844363118217307*^9}, {
   3.8443632282320747`*^9, 3.84436329135179*^9}, {3.8443633223610783`*^9, 
   3.844363453413879*^9}, 3.844363550041972*^9, 3.844363646777666*^9, {
   3.844363851638461*^9, 3.844363869305376*^9}, {3.844381964436314*^9, 
   3.844381967780414*^9}, {3.844382443195059*^9, 3.8443824513365393`*^9}, {
   3.8443828123033447`*^9, 3.8443828569502487`*^9}, {3.844382938584607*^9, 
   3.8443831232847433`*^9}, {3.8444124012730618`*^9, 
   3.8444124014429073`*^9}, {3.844412904526766*^9, 3.8444129358118343`*^9}, {
   3.844412998702949*^9, 3.844413002562703*^9}, {3.844413071484305*^9, 
   3.8444130737848883`*^9}, {3.844439093324278*^9, 3.844439112594678*^9}, {
   3.844443026014229*^9, 3.844443071722849*^9}, {3.844443121376667*^9, 
   3.844443340993576*^9}, {3.844443394073228*^9, 3.844443397364174*^9}, {
   3.844444472895185*^9, 3.8444444990232573`*^9}, {3.844446394415557*^9, 
   3.8444465218691387`*^9}, {3.8444469266481037`*^9, 
   3.8444469286591797`*^9}, {3.844447116819284*^9, 3.8444471470692043`*^9}, {
   3.844447223031239*^9, 3.844447319234934*^9}, 3.844447375032302*^9, {
   3.844449159061233*^9, 3.844449174570567*^9}, 3.8444493963927307`*^9, {
   3.844449514317622*^9, 3.8444495438895273`*^9}, {3.844449632302762*^9, 
   3.844449646371475*^9}, {3.844449809763459*^9, 3.84444984072948*^9}, {
   3.8444503838399076`*^9, 3.8444503840756083`*^9}, {3.8444520303211823`*^9, 
   3.8444520525404177`*^9}, {3.844517692747608*^9, 3.844517696539362*^9}, 
   3.851897792531252*^9, 3.851940465421886*^9, {3.851976863638783*^9, 
   3.851976864076066*^9}, {3.8519798225977173`*^9, 3.851979822925825*^9}, {
   3.8519809664056396`*^9, 3.851980972097292*^9}, {3.851981372109047*^9, 
   3.85198138140178*^9}, {3.85584250522375*^9, 3.855842554160181*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"b40c1232-41dc-4a24-a91c-604b7cee476f"]
},
WindowSize->{1149.75, 633.75},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.1 Inherited,
FrontEndVersion->"12.1 for Linux x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"baa9e973-b092-4ce9-8ace-35af315b0a1f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 201055, 4819, 17823, "Input",ExpressionUUID->"b40c1232-41dc-4a24-a91c-604b7cee476f"]
}
]
*)

